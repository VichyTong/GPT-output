[
    "**Image processing for probabilistic mapping**",
    "1.",
    "Prepare the target stack image.",
    "Here, we prepare the 16-bit TIFF stack images \\(bright field and fluorescence images) that are freely available in the \"LIPS database\":http://hasezawa.ib.k.u-tokyo.ac.jp/lips/ \\(**Figure 1**).\r\n  ",
    "2. Run the ImageJ software \"http://rsbweb.nih.gov/ij/\":http://rsbweb.nih.gov/ij/.\r\n  3.",
    "Open the target image using the ImageJ menu \u201cFile-Open\u201d.",
    "\"http://rsbweb.nih.gov/ij/docs/guide/userguide-23.html#toc-Subsection-23.2\":http://rsbweb.nih.gov/ij/docs/guide/userguide-23.html#toc-Subsection-23.2.\r\n  4.",
    "Draw the major stomatal pore line on the bright field image using the ImageJ tool bar \u201cStraight Line Selection Tool\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-18.html#toc-Subsection-18.2\":http://rsbweb.nih.gov/ij/docs/guide/userguide-18.html#toc-Subsection-18.2 \\(**Figure 2a**).\r\n  ",
    "5. Copy the segmented straight line from the bright field image to the fluorescence images using the ImageJ menu \u201cEdit-Selection-Restore Selection\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-24.html#toc-Subsection-24.12\":http://rsbweb.nih.gov/ij/docs/guide/userguide-24.html#toc-Subsection-24.12 \\(**Figure 2b**).\r\n  ",
    "6. Rotate the fluorescence image using the ImageJ menu \u201cPlugins-kbi-Kbi_registration \\(mode: horizoner)\u201d \\(**Figure 2c**).\r\n  ",
    "7. Get the maximum intensity projection image using the ImageJ menu \u201cImage-Stacks-Z project\u2026\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.6\":http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.6 \\(**Figure 2d**).\r\n  ",
    "8. Put a bounding box around the cell using the ImageJ tool bar menu \u201cRectangular Selection Tool\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-18.html#toc-Subsection-18.1\":http://rsbweb.nih.gov/ij/docs/guide/userguide-18.html#toc-Subsection-18.1 \\(**Figure 2e**).\r\n  ",
    "9.",
    "Crop the boxed cell region using the ImageJ menu \u201cImage-Crop\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.8\":http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.8 \\(**Figure 2f**).\r\n  ",
    "10.",
    "If the is pore located in the upper half of the cropped image, rotate the image 180 degrees using the ImageJ menu \u201cImage-Transform-Rotate\u2026\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.12\":http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.12.\r\n  11.",
    "Resize the images to the same size using the ImageJ menu \u201cImage-Adjust-Size\u2026\u201d \"http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.2\":http://rsbweb.nih.gov/ij/docs/guide/userguide-25.html#toc-Subsection-25.2.",
    "Here, we resized all images to 304\u00d7119 pixels, which was the mean size of the guard-cell bounding boxes.\r\n  12.",
    "Make a stack image of the grouped images using the ImageJ menu \u201cPlugins-kbi-Kbi_StkJoin \\(mode: all axis: z)\u201d.",
    "\\(**Figure 2g**).\r\n  ",
    "13.",
    "Run the macro hig_Pdmapping.ijm \"http://hasezawa.ib.k.u-tokyo.ac.jp/zp/Kbi/HigPDMClustering\":http://hasezawa.ib.k.u-tokyo.ac.jp/zp/Kbi/HigPDMClustering.",
    "You will see the probability map \\(**Figure 2h**).\r\n  ",
    "14.",
    "Save the probability map image using the ImageJ menu \u201cFile-Save\u201d.\r\n  ",
    "**Measurement of raster-scanned intensity profiles**",
    "1.",
    "Run the \u2018ImageJ\u2019 software.\r\n  ",
    "2. Open the stack image of the probability maps using the ImageJ menu \u201cFile-Open\u201d.\r\n  ",
    "3.",
    "To reduce the data size, shrink the image size using the ImageJ menu \u201cImage-Adjust-Size\u2026\u201d.",
    "Here, we reduced the size to 70\u00d727 pixels.\r\n  ",
    "4.",
    "Run the macro hig_Lineprofile.ijm \"http://hasezawa.ib.k.u-tokyo.ac.jp/zp/Kbi/HigPDMClustering\":http://hasezawa.ib.k.u-tokyo.ac.jp/zp/Kbi/HigPDMClustering.\r\n  ",
    "5.",
    "You will see the Results table of the raster-scanned intensity profiles \\(**Figure 3**).\r\n  ",
    "6.",
    "Uncheck the checkbox \u2018Save column headers\u2019 and \u2018Save row numbers\u2019 using the Results table menu \u201cResults-Options\u2026\u201d.\r\n  ",
    "7. Save the raster-scanned intensity profiles as a csv file using the Results table menu \u201cFile-Save As\u2026\u201d.\r\n  ",
    "**SOM clustering with ImageJ**",
    "1.",
    "Run the \u2018ImageJ\u2019 software.\r\n  ",
    "2. Open the stack image of the probability maps using the ImageJ menu \u201cFile-Open\u201d.\r\n  ",
    "3. Run the plug-in using the ImageJ menu \u201cPlugins-kbi-Kbi_Clustering\u201d and select \u2018som\u2019 in the modeClustering drop-down list.\r\n  ",
    "4.",
    "Select \u2018sampleZ_featureCsv_patchImg\u2019 in the somMode drop-down list.\r\n  ",
    "5. Load the csv file of the raster-scanned intensity profiles.\r\n  ",
    "6.",
    "You will see the SOM image \\(**Figure 4**).",
    "In the case that multiple images were allocated in same node in SOM, the images will be allocated in next slice of the stack image \\(SOM output) \\(**Figure 4**)."
]