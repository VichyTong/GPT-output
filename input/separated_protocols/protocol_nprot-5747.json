[
    "**Preparation of dual-gRNA library**",
    "_Library design_",
    "1) Identify genes and gene pairs to be tested in assay.",
    "In the associated publication we describe the testing of a square matrix of all pairwise interactions between 73 genes \\(73 x 73).",
    "However, the both gRNA for a dual-gRNA construct are directly specified during oligonucleotide synthesis thereby enabling the library constituents to be exactly defined to facilitate custom gRNA-pairing.",
    "Thus asymmetric formats \\(eg.",
    "10 x 250, 25 x 100, ect.) are also possible. ",
    "2) Design 20 bp gRNA to target each gene.",
    "Multiple on-line resources to design gRNA are now available13-15.",
    "Poly-T sequences \\(i.e.",
    ", more than two consecutive T's) should be avoided and, to avoid off-target editing, gRNAs should require at least three substitutions in order to match any other sequence in the genome.",
    "We selected three gRNA per gene, it is possible to select more gRNA per gene.",
    "The total number of unique elements in the library, including non-targeting controls, should not exceed ~50,000 in order to keep tissue culture manageable.",
    "Ideally all steps of the process should be performed with a minimum of 200X coverage, meaning 200 unique copies of each gRNA.",
    "For a library of 50,000 elements this would require 10 mil cells.",
    "_",
    "Cloning Step 1: paired gRNA cloning_",
    "1) Purchase pooled oligonucleotide libraries from commercial vendor such as CustomArray \\(Bothell, WA).",
    "2) Amplify full-length oligonucleotides with dual gRNA spacers \\(i.e.",
    ", 20-bp sequences used for targeting desired genes) using PCR using Kapa Hifi enzyme \\(Kapa Biosystems).",
    "Set up PCR reactions according to the manufacturer\u2019s protocol, using 1 \u03bcL of synthesized oligonucleotide template \\(typically around 20 ng), an annealing temperature of 55 \u00b0C, and an extension time of 15 s. The numbers of cycles of amplification should fall within the linear phase of amplification",
    "Primer sequences: ",
    "OLS_gRNA-SP_F: TATATATCTTGTGGAAAGGACGAAACACCG",
    "OLS_gRNA-SP_R: CTTATTTTAACTTGCTATTTCTAGCTCT",
    "3) Repeat ten 50 \u00b5L PCR reactions for each library, this is to obtain high yield coverage of the PCR products.",
    "Too much genomic starting material can interfere with PCR reaction, which is why to parallel reactions are needed.",
    "4) Run PCR product on 2% agarose gel electrophoresis, separate the 144 bp amplicon and purify with the QIAquick gel extraction kit \\(QIAGEN).",
    "5) Digest gRNA-LGP vector with BsmBI \\(New England Biosciences) via the following reaction at 55\u00b0C for 3 hours:",
    "gRNA-LGP vector      4 \u03bcg",
    "Buffer 3.1  5 \u03bcL",
    "10\u00d7 BSA 5 \u03bcL",
    "BsmBI 3 \u03bcL",
    "H2O Up to 50 \u03bcL",
    "6) After digestion, treat vector with 2 \u03bcL of Calf Intestinal Alkaline Phosphatase \\(New England Biosciences) at 37\u00b0C for 30 minutes,",
    "7) Purify with QIAquick PCR Purification Kit \\(Qiagen)",
    "8) Assemble the paired gRNAs into the vector using 10 Gibson assembly reactions in parallel with reactions as follows: ",
    "Linearized gRNA-LGP vector  200 ng",
    "Dual gRNA inserts 36 ng \\(molar ratio 1:10)",
    "2\u00d7 Gibson Assembly Master Mix \\(NEB) 10 \u03bcL",
    "H2O  Up to 20 \u03bcL",
    "9) Incubate at 50\u00b0C for 1 hour",
    "10) Purify with QIAquick PCR Purification Kit \\(Qiagen)",
    "11) Transform into One Shot Stbl3 Chemically Competent E. coli \\(Invitrogen).",
    "Approximately twenty parallel transformations are needed to ensure adequate library representation.",
    "12) Calculate library coverage: remove a small fraction \\(20-100 \u03bcL) of cultures and spread on carbenicillin \\(50 \u03bcg/ml) LB plates ",
    "13) Amplify rest of cultures overnight in 150 ml LB medium, maintaining ~100X library coverage ",
    "14) Extract plasmid DNA using the HiSpeed Plasmid Maxi Kit \\(Qiagen)",
    "15) Pick twenty independent clones for Sanger-sequencing to estimate the overall quality of the library",
    "_",
    "Cloning Step 2: Insertion of the gRNA scaffold and the mouse U6 promoter_",
    "1) Use BsmBI to digest the step 2 library plasmids as per the following reaction at 55\u00b0C for 3 hours:",
    "Cloning Step 1 library 4 \u03bcg",
    "Buffer 3.1  5 \u03bcL",
    "10\u00d7 BSA 5 \u03bcL",
    "BsmBI 3 \u03bcL",
    "H2O Up to 50 \u03bcL",
    "2) Treat the linearized plasmids with 2 \u00b5L of Calf Intestinal Alkaline Phosphatase  at 37\u00b0C for 30 minutes; ",
    "3) Gel-purified cut plasmids using via 0.6% agarose gel electrophoresis and QIAquick gel extraction ",
    "4) Concurrently, digested the step 3 inserts with BsmBI per the following reaction at 55 \u00b0C for 3 hours.",
    "The inserts should be synthesized commercially \\(Integrated DNA Technologies or similar) and cloned into a TOPO vector.",
    "See sequence of insert below. ",
    "Purified step 2 insert PCR product 0.8 \u03bcg",
    "Buffer 3.1  5 \u03bcL",
    "10\u00d7 BSA 5 \u03bcL",
    "BsmBI 3 \u03bcL",
    "H2O Up to 50 \u03bcL",
    "Sequence of the step 2 insert, with left-gRNA scaffold \\(_italicized_) and mU6 promoters \\(**bold**):",
    "TATGAGGACGAATCTCCCGCTTATACGTCTCT _GTTTCAGAGCTATGCTGGAAACTGCATAGCAAGTTGAAATAAGGCTAGTCCGTTATCAACTTGAAAAAGTGGCACCGAGTCGGTGCTTTTTT_",
    "GTACTGAGTCGCCCA *",
    "*GTCTCAGATAGATCCGACGCCGCCATCTCTAGGCCCGCGCCGGCCCCCTCGCACAGACTTGTGGGAGAAGCTCGGCTACTCCCCTGCCCCGGTTAATTTGCATATAATATTTCCTAGTAACTATAGAGGCTTAATGTGCGATAAAAGACAGATAATCTGTTCTTTTTAATACTAGCTACATTTTACATGATAGGCTTGGATTTCTATAAGAGATACAAATACTAAATTATTATTTTAAAAAACAGCACAAAAGGAAACTCACCCTAACTGTAAAGTAATTGTGTGTTTTGAGACTATAAATATCCCTTGGAGAAAAGCCTTGTTT** GAGAGACGGTACAAGCACACGTTTGTCAAGACC",
    "5) Ligate with following reaction, involving overnight incubation at 16\u00b0C followed by heat inactivation at 65\u00b0C for 10 minutes:",
    "10X T4 DNA Ligase Buffer 2 \u03bcL",
    "Step 1 library, digested  100 ng",
    "Step 2 insert, digested  100",
    "ng",
    "T4 DNA Ligase \\(high concentration)",
    "1 \u03bcL",
    "H2O Up to 20 \u03bcL",
    "6) Transform 4 \u00b5L of reaction from step \\(5) into 100 \u00b5L  of ElectroMAX Stbl4 Competent Cells \\(Invitrogen) according to the manufacturer\u2019s protocol using an Eppendorf Electroporator.",
    "Spread a small fraction \\(1-10 \u00b5L) of cultures on carbenicillin \\(50 \u03bcg/ml) LB plates to calculate the library coverage.",
    "Use rest of the cultures to plate on ten 15 cm LB- carbenicillin plates and grow overnight at 37\u00b0C for amplification.",
    "Likely two parallel transformations were required to get ~100X library coverage.",
    "7) Extract plasmid DNA using HiSpeed Plasmid Maxi Kit \\(Qiagen).",
    "Library diversity is determined by deep sequencing.",
    "**Viral production**",
    "_",
    "Note: it is important to check your HEK cells for contamination with mycoplasma before using them for the production of lentiviral particles.",
    "_",
    "1) To produce lentivirus, seed HEK293T cells in 15 cm tissue culture dishes one day before transfection so that they are 70-80% confluent at the time of transfection.",
    "HEK293T cells to be maintained in DMEM medium supplemented with 10% fetal bovine serum. ",
    "2) On day of transfection, change to fresh culture media. ",
    "3) For each 15 cm dish, dilute 36 \u00b5L of Lipofectamine 3000 \\(Life Technologies) in 1.2 mL OptiMEM \\(Life Technologies).",
    "4) Separately, dilute 3 \u00b5g pMD2.G \\(Addgene #12259), 12 \u00b5g of pCMV delta R8.2 \\(Addgene #12263), 9 \u00b5g of lentiviral vector and 48 \u00b5L of P3000 Reagent in 1.2 mL OptiMEM.",
    "Incubate for 5 min at room temperature.",
    "5) After incubation, combine the Lipofectamine 3000 mixture and DNA mixture and incubate at room temperature for 30 min. ",
    "6) Add the mixture dropwise to HEK293T cells. ",
    "7) Return HEK293T cells to incubator, remove and collect media 48 hours after transfection to harvest virus.",
    "Replace with fresh media.",
    "8) Remove and collect media again 72 hours after transfection.",
    "9) Combine 48 and 72 hr harvests and further concentrate virus using Centricon Plus-20 centrifugal ultrafilters with a cutoff 100,000 NMWL \\(Millipore) to a final volume of 450 \u00b5L, then aliquot and freeze at -80\u00b0C.",
    "**Cas9 cloning**",
    "Prior to screening cell lines must be engineered to express the CRISPR Cas9 nuclease.",
    "This can be done by stable integration into the human AAVS1 site, or using a lentiviral vector to package a Cas9 expression plasmid such as Addgene #52962, followed by antibiotic selection to for cells with the Cas9 vector.",
    "**Competitive growth experiments**",
    "_",
    "Note: It is important to maintain coverage \\(ideally 200X) at all stages of the competitive growth experiment.",
    "Also, at least 2 biological replicates \\(independent transductions) are needed for each cell line and/or condition of interest.",
    "_",
    "1) Package the pooled library of double gRNA constructs into lentivirus \\(see above)",
    "2)",
    "Titer the library virus in the cell line of interest.",
    "The transduction efficiency of certain cell lines can be significantly less than 293T, so it is important to establish the functional titer in your specific cell line.",
    "3) Day",
    "-1",
    ":",
    "On day prior to transduction plate sufficient cells so that by next day there will be at three times the desired minimum coverage by day 1.",
    "For example, for 200X coverage of a 50,000 element library 30 mil cells would be needed.",
    "Use sufficient number of plates so that cells will be ~50%-60% confluent on day 1.",
    "To facilitate growing these large number of cells we use 245 mm x 245 mm Bioassay dishes \\(Corning).",
    "4) Day 0: Transduce cells with gRNA library virus at MOI of 0.3 or lower to ensure that each cell had 0-1 double gRNA constructs.",
    "Because approximately 2/3 of the cells will be killed it is important to start transduction with three times the desired minimal coverage.",
    "5) Day 1: Change media to remove virus",
    "6) Day 2: Passage cells if they are greater than 85% confluent, otherwise leave until Day 3",
    "7) Day 3: Count and passage cells.",
    "Freeze down enough cells to account for minimum desired coverage \\(snap freeze in N2, store at -80 C).",
    "Re-plate enough cells to account for minimum desired coverage.",
    "Start puromycin selection at predetermined selection dose.",
    "8) Days 4-28: Keep cells in exponential growth by passaging every 2-4 days as needed for your cell line.",
    "At every passage, re-plate enough cells to account for minimum desired coverage and freeze the rest.",
    "9) Extract DNA from cells harvested at 3, 14, 21 and 28-day time points using the Blood and Cell Culture DNA Mini Kit \\(Qiagen) according to manufacturer protocols. ",
    "**NGS library preparation**",
    "1) Quantitate DNA extracted from step #9 above to ensure there is adequate coverage prior to starting library preparation.",
    "The dual gRNA cassette will be amplified and prepared for deep sequencing using two steps of PCR.",
    "2) PCR 1: Perform this as 10 separate 50 \u03bcL reactions with 2 \u03bcg input genomic DNA per reaction \\(total 20 \u03bcg for each sample) using Kapa Hifi enzyme.",
    "PCR primers are as follows: ",
    "NGS_dual-gRNA_SP_Lib_F: ACACTCTTTCCCTACACGACGCTCTTCCGATCT TATATATCTTGTGGAAAGGACGAAACACCG",
    "NGS_dual-gRNA_SP_Lib_R:  GACTGGAGTTCAGACGTGTGCTCTTCCGATCT CCTTATTTTAACTTGCTATTTCTAGCTCTA",
    "Thermocycling parameters are: 95\u00b0C for 30 s, 21-26 cycles of \\(98\u00b0C for 15 s, 55\u00b0C for 15 s, 72\u00b0C for 45 s), and 72\u00b0C for 5 min. Test the numbers of cycles to fall within the linear phase of amplification.",
    " ",
    "3) Pool amplicons \\(600 bp) of 10 reactions for each sample then size-select and purify with Agencourt AMPure XP beads \\(Beckman Coulter) at 0.8 ratio.",
    "4) Further purify with QIAquick PCR Purification \\(Qiagen).",
    "5) PCR 2: Use 4 separate 50 \u03bcL reactions with 5 ng of first-step PCR product per reaction \\(total 20 ng for each sample), using Next\u00ae Multiplex Oligos for Illumina \\(New England Biosciences) to attach Illumina adaptors and indexes.",
    "The thermocycling parameters are: 95\u00b0C for 30 s, 7-8 cycles of \\(98\u00b0C for 15 s, 72\u00b0C for 45 s), and 72\u00b0C for 5 min. ",
    "6) Pool amplicons from these 4 reactions then size-select and purify twice using Agencourt AMPure XP beads at 0.8 ratio.",
    "7) Quantify the purified second step PCR library using real-time PCR with Illumina Library Quantification kit \\(Kapa Biosystems). ",
    "**Next-generation sequencing**",
    "Sequencing should be performed at a core facility with experience working with amplicon-based sequencing.",
    "To identify both gRNA on each construct 75 bp paired-end reads are required.",
    "Given the lack of base diversity in the amplicon it is necessary to spike in ~20",
    "%",
    "PhiX when sequencing using Illumina HiSeq Rapid run.  ",
    "**Processing of paired-end reads, fitness estimation, and calculation of interaction scores**",
    "A software pipeline to analyze the raw sequencing data is available here: ",
    "http://ideker.ucsd.edu/papers/rsasik2017/",
    "Below is a brief description of how the pipeline processes the raw data.",
    "Inputs to the pipeline are FASTQ files for two replicates at Day 3, Day 14, Day 21, and Day 28 time points.",
    "1) Trim FASTQ files of scaffold sequence using cutadapt16, discarding trimmed reads of unexpected lengths <19 or >21 bps.",
    "2) Truncate remaining reads to 19 bases from the appropriate end, reverse-complement reads from reverse strand. ",
    "3) Check both reads in a pair for sequence matches against gRNA sequences used in the library, allowing one mismatch anywhere in a read. ",
    "4) Aggregate read pairs that matched to a known construct to compute the total counts for each construct in the relevant sample.",
    "5) Fit linear regression to each gRNA to determine fitness, removing data points that fall below minimum threshold of raw sequencing reads.",
    "6) Rank gRNA for each gene by absolute fitness effect and assign weights.",
    "7)",
    "Combine the weighted values for the 3 gRNA per gene to determine fitness effect for each gene",
    "8) Determine genetic interactions from measured fitness of double gRNA constructs and expected double knockout fitness calculated from single gene finesses \\(f<sub>c</sub>=f<sub>p</sub>+f<sub>p'</sub>+\u03c0<sub>pp'</sub>) where \u03c0<sub>pp'</sub> is the interaction, f<sub>c</sub> is the measured double gRNA fitness, and f<sub>p</sub> and f<sub>p'</sub> are the single gene effects."
]