[
    "Core inoFISH protocol",
    "This is the basic inoFISH protocol used in several steps of the experimental procedure, below.",
    "This protocol is consistent with our in-house inoFISH protocol, available in this Google Doc, which we will continuously update as we tweak experimental conditions as we find them to be useful:  https://goo.gl/ujxex1 .",
    "The procedure as of May 3, 2017, used for inoFISH experiments in the publication associated with this protocol, is as follows:",
    "Pre-inoFISH",
    "Cell fixation",
    "NOTE:",
    "All steps should be done in chemical hood with ventilation.",
    "Time required: Fixation: 15 minutes; Permeabilization: at least 1 hour.",
    "For multi-chambered slides \\(cultured cells):",
    "1.",
    "Aspirate off media with vacuum.\r\n  ",
    "2.",
    "Add 1 mL PBS per well to rinse, aspirate off.\r\n  ",
    "3. Repeat 1 mL PBS rinse and aspirate.\r\n         ",
    "5",
    " 4.",
    "Add 1 mL Fixation solution to each well.",
    "Allow to fix cells for 10 minutes.",
    "Aspirate off fixation solution.",
    "a. Keep fixing time consistent between experiments.",
    "5.",
    "Meanwhile, label the sample\u2019s plate with the fixing date.",
    "Make sure covers and chamber\r\n  of chambered coverslips are labeled \\(to keep track of wells).",
    "6.",
    "Add 1 mL PBS per well to rinse, aspirate off.",
    "Repeat.\r\n  ",
    "7.",
    "Add 1 mL 70% ethanol per well.\r\n  ",
    "8.",
    "Parafilm the plate to prevent evaporation of ethanol.\r\n  ",
    "a. Store at 4C \\(for minimum 1 hour, up to 3 months).",
    "inoFISH",
    "DAY 1: Hybridization",
    "----Prep of probes in hybridization buffer----",
    "Time required: 20 minutes, including thawing of probe stocks",
    "Per well of sample \\(double numbers for 2-well plate):",
    "9.",
    "Add 50\u03bcL hybridization buffer to Eppendorf tube \\(1.5 mL).\r\n  ",
    "a. Hybridization buffer is viscous from dextran sulfate, so vortex then spin down 10.",
    "Add each of the following to the 50\u03bcL hybridization buffer:",
    "a. 1 uL editing site detection single oligo probes at a stock concentration of 0.3-1.2 \u03bcM \\(usually 2 of them at 1\u03bcL each, A/I in Cy3/Cy5)",
    "b. 1 uL mask oligo \\(has common sequence for both SNP probes, added such that mask:probe molar ratio is between 1:1 and 1.5:1; with two detection probes, the range of mask stock concentrations would be 0.6 - 3.6uM)",
    "c. 1 uL guide probe \\(a typical RNA FISH probe with no tiled oligo at the SNP position, ideally in Cal Fluor 610).",
    "For Cal Fluor 610, we use 1uL of 5uM guide probe stock.",
    "----Hybridization----",
    "Time required: 5-15 minutes, depending on the number of samples",
    "11.",
    "Aspirate off 70% ethanol from fixed cell sample well.\r\n  12.",
    "Add 1 mL wash buffer to each sample well.\r\n  ",
    "a. Allow sample to equilibrate for 2-3 minutes.",
    "13.",
    "Aspirate off wash buffer and tilt chamber to get residual liquid.\r\n  ",
    "a. Be quick so other samples don\u2019t dry out.",
    "14.",
    "Add 50 \u03bcL of probe-containing hybridization buffer as a drop in center of sample.\r\n  ",
    "a. Use clean tweezers to place a clean 18 x 18 mm coverslip onto the drop.",
    "b.",
    "Tap down slide gently with tweezers to spread liquid.",
    "15.",
    "Create \u201cmoisturizer\u201d using 1\u20442 of Kimwipe rolled, tied into a pretzel, and saturated with\r\n  750\u03bcL of 2X SSC.",
    "16.",
    "Replace chamber cover, culture plate cover, and and seal with parafilm.\r\n  ",
    "17.",
    "Put in 37\u00b0C incubator overnight \\(or at least 4 hours).\r\n  ",
    "6",
    " DAY 2: Wash, Anti-fade \\(GluOx, Catalase, DAPI), and Imaging",
    "Time required: 35 minutes",
    "----Remove",
    "Coverslip, 1st wash----",
    "18.",
    "Take out samples from 37\u00b0C incubator, remove parafilm.",
    "19. Add 1 mL wash buffer to each sample well.\r\n  ",
    "20.",
    "Use clean tweezers to remove coverglass insert.\r\n  ",
    "a. Don\u2019t crush the sample, discard coverglass insert.",
    "21.",
    "Aspirate off wash buffer and replace with 1 mL fresh wash buffer.",
    "22.",
    "Replace chamber and plate covers, parafilm.\r\n  ",
    "23.",
    "Put back into 37\u00b0C incubator for 30 minutes.\r\n  ",
    "24.",
    "Start thawing DAPI \\(with 10 minutes left to spare).\r\n  ",
    "----2nd wash/DAPI----",
    "Time required: 35 minutes",
    "25.",
    "Remove sample from incubator and remove parafilm.\r\n  26.",
    "Aspirate off wash buffer, add another 1 mL of wash buffer to each sample well.",
    "27.",
    "Add 1 uL DAPI \\(50 ug/mL stock) to each sample well.\r\n  ",
    "28.",
    "Replace covers, parafilm and put back into 37\u00b0C incubator for 30 minutes.\r\n  29.",
    "Meanwhile, set up microscope.\r\n  ",
    "----Glucose Oxidase Prep----",
    "Time required: 10 minutes",
    "Glucose Oxidase \\(GluOx) is required to reduce photobleaching of Cy5 by dissolved oxygen Glucose + Oxygen in sample --\\(GluOx)--> less O2 in sample.",
    "Glucose oxidase stock enzyme is aliquoted out and frozen for storage.",
    "Note:",
    "Glucose oxidase tends to lose potency with repeated freeze/thaw cycles.",
    "In order to keep it working as well as possible, either thaw it out right when needed or by putting it at 4C for 10 minutes until ready to add, then immediately refreeze it.",
    "After about 20 freeze thaws, it\u2019s time for a new aliquot.",
    "30.",
    "During 2nd wash, prepare \"Anti-Fade\" buffer, ~1 mL volume for each Cy5 sample \\(for each well \u2192 double numbers for 2-well plate).\r\n  ",
    "31.",
    "Split anti-fade buffer into 100 & 900 \u03bcL volumes for each well.\r\n  a. 100 \u03bcL is for enzymatic solution, 900 \u03bcL is just buffer for equilibrating sample.",
    "32.",
    "Vortex catalase in its amber vial or aliquots from 4\u00b0C.\r\n  33.",
    "Take out glucose oxidase from -20\u00b0C only when ready to add.\r\n  ",
    "34.",
    "Add 1 \u03bcL of oxidase enzyme and 1 \u03bcL of catalase to 100 \u03bcL anti-fade buffer.\r\n  ",
    "----Final Wash and addition of glucose oxidase solution \\(for Cy5)----",
    "Time required: 5 minutes",
    "35.",
    "Aspirate off wash buffer and add 1 mL of 2X SSC at room temperature, wait 1 minute.\r\n  36.",
    "Aspirate off 2X SSC and add 900 \u03bcL of anti-fade \\(no enzyme) buffer to each sample\r\n  well.",
    "Allow to equilibrate for 1 minute at room temperature then aspirate.",
    "37.",
    "Add 100 \u03bcL of Anti-fade with GluOx and Catalase to center of sample.\r\n  ",
    "38.",
    "Use clean tweezers to add clean coverslip to lightly squash & reduce O2.\r\n  ",
    "7",
    " ----Imaging----",
    "Time required: usually 10-15 minutes per 100x field of view \\(time per sample depends on the number and size of cells you want to capture, as well as exposure times)",
    "Sample is now ready for imaging.",
    "Imaging can be done over several hours \\(store at 4\u00b0C in between imaging sessions; at this temperature samples may also be stored overnight with 1mL 2X SSC in the well prior to imaging).",
    "If imaging for > 4 hours in a single well, replace that well\u2019s 100uL",
    "Anti-fade + GluOx and Catalase every 4 hours.",
    "As with regular smFISH, to image a cell properly, each image stack should cover the entire body of a cell \\(start blurry at the bottom of the cell, and end blurry at the top of the cell).",
    "inoFISH image analysis pipeline",
    "This is the computational workflow that we use for analyzing inoFISH experiments.",
    "It is time-consuming.",
    "For an experiment with <sub>200 imaged cells spread over two experimental conditions the full image data analysis pipeline will often take  </sub>16 working hours  to complete.",
    "All image inspection and spot calling is conducted entirely in the rajlabimagetools software package.",
    "We strongly recommend familiarizing oneself with this software and its use in simpler smFISH experiments prior to starting an inoFISH experiment: https://bitbucket.org/arjunrajlaboratory/rajlabimagetools/wiki/workedExample .",
    "The full documentation wiki for rajlabimagetools is here: https://bitbucket.org/arjunrajlaboratory/rajlabimagetools/wiki/browse/ .",
    "The SNP FISH analysis pipeline guide is here, and it is directly compatible with inoFISH guide-detection probe colocalization analyses: https://bitbucket.org/arjunrajlaboratory/rajlabimagetools/wiki/SNPFISH%20Colocalization%20Us er%20Guide .",
    "Please see the rajlabimagetools wiki for a complete description of how to organize your image files and load them into rajlabimagetools.",
    "In brief,",
    "1.",
    "Cell segmentation\r\n  2.",
    "Preliminary processing and spot calling\r\n  3.",
    "Manual inspection of spot intensity thresholds in all channels, with particularly careful\r\n  attention paid to detection probe channels.",
    "a. NOTE:",
    "This is the single most time-consuming and difficult step of inoFISH",
    "experiments.",
    "We have developed multiple tools in rajlabimagetools that allow you to inspect individual fluorescent channels and collections of channels.",
    "See the wiki for details.",
    "b.",
    "We recommend having a second person, ideally someone who also works with smFISH data, review your spot calls.",
    "We found this type of analysis review to rapidly improve the quality of detection probe spot calls.",
    "i.",
    "This will be time-consuming for your colleague, as well.",
    "     ",
    "8",
    " 4.",
    "Gaussian spot position fitting",
    "a.",
    "This process refines spot position estimates.",
    "5. Guide-detection spot colocalization\r\n  6.",
    "Manual inspection of colocalization events with re-review of detection spot calls\r\n  a. NOTE:",
    "This is time-consuming.",
    "We again recommend having a colleague review your results as a sanity check.",
    "b. Review your spot calls multiple times for consistency.",
    "c. Re-threshold spots as needed and update Gaussian fitters/spot colocalizers",
    "automatically.",
    "7.",
    "Pixel-shift colocalization analysis\r\n  8.",
    "Extraction and exporting of processed data as required for downstream analyses.",
    "Some examples of data tables that you might find useful are demonstrated in worked examples in the wiki: https://bitbucket.org/arjunrajlaboratory/rajlabimagetools/wiki/SNPFISH%20Colocalization %20User%20Guide .\r\n  ",
    "Overall experimental procedure",
    "Select a target editing site in a transcript of interest",
    "1.",
    "Identify the genomic coordinates of the editing site of interest.\r\n  ",
    "2. Download a RefSeq-annotated reference genomic sequence of the full transcript with\r\n  the editing site.",
    "We will use this for RT-PCR primer design and for inoFISH probe design.",
    "We use the UCSC browser tool with the following options:",
    "a. Sequence Retrieval Region Options:",
    "i. 5\u2019 UTR Exons",
    "ii.",
    "CDS Exons",
    "iii. 3\u2019 UTR Exons",
    "iv.",
    "One FASTA record per region, 0 upstream, 0 downstream",
    "v. Split UTR and CDS exons into separate FASTA records",
    "b. Sequence Formatting Options:",
    "i. Exons in upper case, everything else in lower case",
    "3.",
    "Download reference genome sequence corresponding to the locus around the editing\r\n  site, about 400-bp upstream and 400-bp downstream.",
    "We only need this for gDNA PCR primer design.",
    "Use bulk assay techniques, such as gDNA PCR and RT-PCR with Sanger sequencing, to preliminarily check for any editing at this site in biological samples of interest",
    "4.",
    "Design gDNA PCR and RT-PCR primers such that your product will contain amplified sequence at the editing site.",
    "We recommend designing primers such that your products:\r\n  ",
    "a. Have the editing site 100bp - 400bp from both ends of the amplicon \\(or from internal Sanger sequencing primer sites).",
    "   ",
    "9",
    " b.",
    "Are < 1-kbp in length",
    "c. Optional: design additional internal Sanger sequencing primers for each",
    "predicted PCR product such that the editing site is still 100bp - 400bp from the",
    "primers.",
    "5. Culture two replicates of a biological sample of interest.\r\n  ",
    "6.",
    "Harvest genomic DNA from one replicate your cultured sample of interest.",
    "We have\r\n  used the DNeasy Blood & Tissue Kit \\(Qiagen) for cultured human cell lines, but feel free",
    "to use whatever works for you.",
    "Store at -20C until ready to perform PCR.",
    "7.",
    "Harvest total RNA from one replicate of your cultured sample of interest.",
    "We have used\r\n  the miRNeasy Mini Kit \\(Qiagen) for cultured human cell lines.",
    "Store at -80C until ready to",
    "perform RT-PCR.",
    "8.",
    "Perform gDNA PCR.",
    "We have used Platinum\u00ae Taq DNA Polymerase High Fidelity.\r\n  9.",
    "Perform RT-PCR.\r\n  a.",
    "For RT we have used the SuperScript III First-Strand Synthesis System with included oligo-dT primers.",
    "b.",
    "For PCR we have used Platinum\u00ae Taq DNA Polymerase High Fidelity.",
    "10.",
    "Check amplification by running on an agarose gel \\(with Ethidium Bromide or SYBR\r\n  Safe).",
    "11.",
    "Eliminate residual dNTPs with ExoSAP-IT.\r\n  12.",
    "Sanger sequence gDNA PCR and RT-PCR products.\r\n  ",
    "13.",
    "Verify RNA editing by comparing Sanger sequencing traces at the editing site in gDNA\r\n  PCR and RT-PCR products.",
    "At the editing site the genomic product should be homozygous A, whereas the RT product should have a mixed A, G trace \\(or entirely G if editing is 100% efficient at this site).",
    "Check inoFISH compatibility of target editing site",
    "14.",
    "Computationally isolate the RT-PCR product Sanger sequencing results for the 81-bp region \\(40-bp upstream and 40-bp downstream) of the target editing site.\r\n  15.",
    "In RT-PCR results, ensure that there are no other nearby heterozygous SNPs, indels, or RNA editing sites leading to transcript base variation near the specific editing site of interest.\r\n  ",
    "a. CRITICAL STEP: if the transcript has additional base variation near the particular editing site of interest, it may not be possible to design detection probes \\(usually 20-nt - 35-nt) such that the only variation in the detection probe target sequence is the editing site of interest.",
    "Design inoFISH guide and detection probes",
    "16.",
    "Perform smFISH probe design for the full transcript as previously described *****cit.",
    "a. CRITICAL STEP: if the transcript is too short or contains too many repetitive\r\n  sequences to fit at least 24 oligonucleotide guide probes, then the inoFISH guide may not work, and inoFISH may fail for this target.",
    "10",
    " 17.",
    "Perform inoFISH detection probe design for the editing site.",
    "We use the SNV FISH snpfishdesign pipeline, as previously described.",
    "In order to create detection probes that target the unedited and edited versions of the editing site, use a \u201cSNPList\u201d file with a \u201cSNP\u201d at the position \\(coordinate on reference chromosome) of the editing site with alleles T/C. ",
    "a. CRITICAL STEP: it must be possible to design detection probes overlapping the editing site or inoFISH will fail.",
    "18.",
    "The inoFISH detection probe design pipeline will provide one detection probe per editing status and shorter probe-complementary masks of three different lengths.",
    "inoFISH experiments require at least: both detection probes and one mask.",
    "Since the masks are unmodified oligos, we recommend ordering all three options preemptively in the interest of efficient probe set optimization \\(discussed below).\r\n  ",
    "Screen candidate inoFISH probe sets for optimal signal-to-noise ratio",
    "19.",
    "For a small set of combinations of detection probe concentrations and mask length conditions, culture replicates of some simple control samples, for which you have at least RT-PCR with Sanger sequencing as a baseline rough estimate of cell population-wide editing level at the site of interest.\r\n  a. Note: if you have other estimates of editing level at this site in these samples, such as RT-PCR with restriction endonuclease digestion or high-read-depth RNA-seq data, even better\\!",
    "20. Use the above core inoFISH protocol for each candidate probe set concentration and mask length condition.\r\n  ",
    "a. Note: If considering more than two probe set conditions, it may make sense to stage FISH experiments over several days, as imaging of detection probe spots often require time-consuming, long exposure times.",
    "21.",
    "Complete the above inoFISH image analysis pipeline for each candidate probe set condition.\r\n  ",
    "22.",
    "Compare colocalization rates and pixel-shift false-positive colocalization across probe set conditions.",
    "Proceed to the next step of the experimental procedure if you have a probe set condition with an observed colocalization rate and a pixel-shift rate with which you can power an experiment of interest.\r\n  ",
    "a. See the associated publication\u2019s Supplementary Note for a discussion of the quantitative analysis of inoFISH experiments.",
    "b.",
    "If none of the probe set conditions produce satisfactory colocalization rates and pixel-shift rates, try a couple other conditions.",
    "However, please note that we have encountered a one editing site for which we were unable to generate a probe set after testing six probe set conditions.",
    "We are not sure why this site was resistant",
    "to probe design",
    "23.",
    "Ensure that swapping the dyes conjugated to your optimal probe set\u2019s detection probes\r\n  also gives you a good signal-to-noise \\(colocalization-to-pixel-shift) ratio.",
    "Conduct inoFISH experiments and editing level analyses",
    "24.",
    "Use your optimal probe set in a set of experiments of interest.",
    "Make sure that they are powered to detect the effect size for which you are interested in testing.",
    "For a discussion of quantitative editing level analysis, see the Supplementary Note of the manuscript with which this protocol is associated."
]