[
    "<p><strong>WET-LAB PROCEDURES</strong></p><p><strong>",
    "Protein Purification</strong></p><p>",
    "All the necessary proteins needed for NPC localizations and transport experiments are obtained by overproduction in <em>Escherichia coli</em>, and then purified by standard biochemical methods, as described in the following sections.&nbsp;All protein concentrations can be determined by the investigator\u2019s favorite method.&nbsp;We ",
    "Determine concentrations by the densitometry of bands on SDS-PAGE gels stained with Coomassie Blue&nbsp;R-250 using bovine serum albumin as a standard.&nbsp;When needed, antibiotics should be added at 50 \u00b5g/mL for ampicillin (Amp) and 30 \u00b5g/mL for kanamycin (Kan).&nbsp;All cells with overproduced proteins can be stored at -80\u00b0C until needed, or used immediately.&nbsp;All purified proteins can be stored at -80\u00b0C until use.</p><p>&nbsp;</p><p><strong><em>RanGDP</em>: <",
    "em>&nbsp;</em></strong></p><p>1)&nbsp;&nbsp;Inoculate BL21(DE3) cells transfected with pQE32-Ran<sup>22</sup> into 5 mL of LB with 2% glucose + Amp, and culture overnight at 37\u00baC.&nbsp;</p><p>2)&nbsp;&nbsp;The following day, ",
    "Transfer the starter culture to 1 L of LB with 2% glucose + Amp, and ",
    "Grow at 37\u00baC until an OD<sub>600</sub> of ~0.8 is reached.&nbsp;Induce with 1 mM IPTG and ",
    "Suspend the cells in 20 mL of 20 mM K-Phos, 200 mM NaCl, 0.5 mM MgCl<sub>2</sub>, 10 mM imidazole, 4 mM \u03b2ME, pH 7 + protease inhibitors (PI).&nbsp;Lyse by French press (3X at 16,000 psi), and then ",
    "Centrifuge the lysate (15,000 x <em>g</em>, 20 min, 4\u00b0C).</p><p>4)&nbsp;&nbsp;Mix the supernatant with 0.5 mL Ni-NTA resin, and ",
    "Incubate for 30 min at 4\u00b0C.&nbsp;Transfer the suspension to a gravity column.&nbsp;</p><p>5)&nbsp;&nbsp;Wash the Ni-NTA resin with:</p><p>15 mL 20 mM K-Phos, 500 mM NaCl, 0.5 mM MgCl<sub>2</sub>, 20 mM imidazole, 0.1% TX-100, pH 7.0 + PI</p><p>15 mL 20 mM K-Phos, 50 mM NaCl, 0.5 mM MgCl<sub>2</sub>, 20 mM imidazole, pH 8.</p><p>Elute with 20 mM K-Phos, 50 mM NaCl, 0.5 mM MgCl<sub>2</sub>, 250 mM imidazole, pH 8 collecting 1 mL fractions.</p><p>6)&nbsp;&nbsp;Combine the major elution fractions (typically, the first 2 mL).&nbsp;Purify further by MonoS cation ex",
    "Change chromatography (GE Pharmacia Biotech, #17-0547-01) in 20 mM K-Phos, 50 mM NaCl, 0.5 mM MgCl<sub>2</sub>, pH 8 using a linear NaCl gradient (with 500 mM NaCl in the second buffer) to ",
    "Separate RanGDP (first peak at ~150 mM NaCl) from RanGTP (second peak at ~250 mM NaCl).</p><p>&nbsp;</p><p><strong><em>NTF2</em>:</strong></p><p>1)&nbsp;&nbsp;Inoculate BL21(DE3) cells transfected with pET15b-NTF2<sup>23</sup> into 5 mL of LB + Amp, and culture overnight at 37\u00baC.</p><p>2)&nbsp;&nbsp;The following day, ",
    "PI</p><p>20 mL of 20 mM Tris, 100 mM NaCl, 10 mM imidazole, pH 8.</p><p>Elute with 20 mM Tris, 100 mM NaCl, 250 mM imidazole, pH 8.0 collecting 0.5 mL fractions.</p><p>6)&nbsp;&nbsp;Purify the most concentrated fraction by Superdex 200 size exclusion chromatography (GE Healthcare Bioscience, #28-9909-44) using 20 mM HEPES, 150 mM NaCl, pH 7.3.</p><p>&nbsp;</p><p><strong><em>Imp \u03b21</em>:</strong></p><p>1)&nbsp;&nbsp;Inoculate BL21(DE3) cells transfected with pQE9-Imp \u03b2<sup>25</sup> into 5 mL of LB with 2% glucose + Amp, and culture overnight at 37\u00baC.</p><p>2)&nbsp;&nbsp;The following day, ",
    "Transfer the starter culture to 1 L of LB with 2% glucose + Amp, and ",
    "Grow at 37\u00baC until an OD<sub>600</sub> of ~0.8 is reached.&nbsp;Induce with 0.7 mM IPTG and ",
    "Suspend the cells in 6 mL of 5 mM Tris, 500 mM NaCl, 5 mM MgSO<sub>4</sub>,<sub> </sub>10 mM imidazole, 4 mM \u03b2ME, pH 8.0 + PI.&nbsp;Lyse by French press (3X at 16,000 psi), and then ",
    "Centrifuge the lysate (15,000 x <em>g</em>, 20 min, 4\u00b0C).</p><p>4)&nbsp;&nbsp;Mix the supernatant with 0.5 mL Ni-NTA resin, and ",
    "Incubate for 30 min at 4\u00b0C.&nbsp;Transfer the suspension to a gravity column.</p><p>5)&nbsp;&nbsp;Wash the Ni-NTA resin with:</p><p>20 mL of 5 mM Tris, 500 mM NaCl, 5 mM MgSO<sub>4</sub>, 10 mM imidazole, 4 mM \u03b2ME, 0.1% TX-100, pH 8.0 +",
    "PI</p><p>20 mL of 5 mM Tris, 100 mM NaCl, 10 mM imidazole, pH 8.</p><p>Elute with 5 mM Tris, 100 mM NaCl, 250 mM imidazole, pH 8.0 collecting 0.5 mL fractions.</p><p>6)&nbsp;&nbsp;Purify the most concentrated fraction by Superdex 200 size exclusion chromatography (GE Healthcare Bioscience, #28-9909-44) using 20 mM HEPES, 110 mM KOAc, 5 mM NaOAc, 2 mM MgOAc<sub>2</sub>, 2 mM DTT, pH 7.3 (",
    "Import buffer without EGTA; IBnoEGTA).</p><p><strong><em>&nbsp;</em></strong></p><p><strong><em>Transportin (Imp \u03b22)</em>:</strong></p><p>1)&nbsp;&nbsp;Inoculate BL21-Gold(DE3) cells transfected with pGEX4TT3-TEV-KapBeta2<sup>26</sup> into 20 mL of LB with 2% glucose + Amp, and culture overnight at 37\u00baC.</p><p>2)&nbsp;&nbsp;The following day, ",
    "Transfer the starter culture to 2 L of LB with 2% glucose + Amp, and ",
    "Grow at 25\u00baC until an OD<sub>600</sub> of ~0.6 is reached.&nbsp;Induce with 0.5 mM IPTG and ",
    "Suspend cells in 30 mL of 50 mM HEPES, 150 mM NaCl, 15% glycerol, 2 mM DTT, 2 mM EDTA, pH 7.4 + PI.&nbsp;Lyse by French press (3X at 16,000 psi), and then ",
    "Centrifuge the lysate (15,000 x <em>g</em>, 20 min, 4\u00b0C).</p><p>4)&nbsp;&nbsp;Mix the supernatant with 0.5 mL glutathione Sepharose resin, and ",
    "Incubate for 30 min at 4\u00b0C.&nbsp;Transfer the suspension to a gravity column.</p><p>5)&nbsp;&nbsp;Wash the glutathione Sepharose resin with:</p><p>25 mL of 50 mM HEPES, 100 mM NaCl, 1 mM EGTA, 10 mM MgOAc<sub>2</sub>, 2 mM DTT, 15% glycerol, 5 mM ATP, pH 7.4 + PI</p><p>20 mL of 20 mM HEPES, 20 mM NaCl, 2 mM EDTA, 10% glycerol, 2 mM DTT, pH 7.4.</p><p>6)&nbsp;&nbsp;C",
    "Leave the GST tag off of the transportin protein by incubating the Sepharose resin with 1 mL of 20 mM HEPES, 20 mM NaCl, 2 mM EDTA, 10% glycerol, 2 mM DTT, 0.5 units/\u00b5L TEV protease, pH 7.4 for 2 h at room temperature.&nbsp;The protein can then be collected by eluting with the same buffer (0.5 mL fractions).</p><p>7)&nbsp;&nbsp;Purify the most concentrated fraction by Enrich Sec 650 size exclusion chromatography (Biorad, #7801650) using IBnoEGTA.</p><p>&nbsp;</p><p><strong><em>M9-\u03b2Gal-8C</em>:</strong></p><p>1)&nbsp;&nbsp;Inoculate BL21(DE3) cells transfected with pET30a-M9-\u03b2Gal-8C<sup>27</sup> into 4 mL of LB + Kan, and culture overnight at 37\u00baC.</p><p>2)&nbsp;&nbsp;The following day, ",
    "PI</p><p>20 mL of 5 mM Tris, 100 mM NaCl, 10 mM imidazole, pH 8.0.</p><p>Elute with 5 mM Tris, 100 mM NaCl, 250 mM imidazole, pH 8.0 collecting 0.5 mL fractions.</p><p>6)&nbsp;&nbsp;Purify the most concentrated fraction by Superdex 200 size exclusion chromatography using IBnoEGTA.</p><p>&nbsp;</p><p><strong><em>LaG-9(S151C)</em>:</strong></p><p>1)&nbsp;&nbsp;Inoculate BL21(DE3) cells transfected with pLaG-9(S151C) (",
    "See associated publication) into 5 mL of LB + Amp, and culture overnight at 37\u00baC.</p><p>2)&nbsp;&nbsp;The following day, ",
    "Transfer the starter culture to 1 L of LB + Amp, and ",
    "Grow at 37\u00baC until an OD<sub>600</sub> of ~0.8 is reached.&nbsp;Induce with 0.1 mM IPTG and ",
    "Suspend the cells in 10 mL ice cold 20 mM Tris, 0.5 mM EDTA, 500 mM sucrose, 10 mM \u03b2ME, 0.3 mM MgSO<sub>4</sub>, pH 8.0 + PI.&nbsp;Lyse by French press (3X at 16,000 psi), and then ",
    "Centrifuge the lysate (15,000 x <em>g</em>, 20 min, 4\u00b0C).</p><p>4)&nbsp;&nbsp;Mix the supernatant with 0.5 mL Ni-NTA resin, and ",
    "Incubate for 30 min at 4\u00b0C.&nbsp;Transfer the suspension to a gravity column.</p><p>5)&nbsp;&nbsp;Wash the Ni-NTA resin with:</p><p>15 mL of 20 mM Tris, 900 mM NaCl, 10 mM \u03b2ME, 0.1% TX-100, pH 8.0</p><p>15 mL of 20 mM Tris, 150 mM NaCl, 10 mM imidazole, pH 8.0.</p><p>Elute with 20 mM Tris, 150 mM NaCl, 250 mM imidazole, pH 8.0 collecting 0.5 mL fractions.</p><p>6)&nbsp;&nbsp;Purify the most concentrated fraction by Superdex 75 size exclusion chromatography using 20 mM HEPES, 150 mM NaCl, pH 7.3.</p><p>&nbsp;</p><p><strong>Dye Labeling of Proteins</strong></p><p>The efficiency of dye labeling varies for different proteins and different dyes.&nbsp;Dyes are solubilized in DMSO.&nbsp;Our standard approach is to ",
    "Add different amounts of dye to aliquots of protein sufficient to ",
    "Run on an SDS-PAGE gel, and then ",
    "Analyze these labeled proteins by in-gel fluorescence imaging.&nbsp;For labeling protein stocks, the minimum amount of dye need to ",
    "Obtain saturated (quantitative) labeling is typically used.&nbsp;Maleimides are highly reactive with cysteines, and a 5-10 min incubation period is sufficient to reach the reaction endpoint.&nbsp;The following procedures yield high labeling efficiencies.</p><p>&nbsp;</p><p>HMSiR maleimide is attached to the C-terminal cysteine on the LaG-9(S151C) nanobody by incubating with a 15-fold molar excess at room temperature for 15 min.&nbsp;Excess dye is washed away by binding the nanobody to Ni-NTA resin:</p><p>1)&nbsp;&nbsp;Incubate the dye-protein mixture with 0.1 mL Ni-NTA resin for 30 min.</p><p>2)&nbsp;&nbsp;Wash the resin-bound protein with 20 mL of 20 mM HEPES, 500 mM NaCl, 0.1% TX-100, 4 mM BME, pH 7.3.</p><p>3)&nbsp;&nbsp;Wash with 10 mL of 20 mM HEPES, 150 mM NaCl, pH 7.3 to ",
    "Re",
    "Move the detergent.</p><p>4)&nbsp;&nbsp;Elute the labeled nanobody with 20 mM HEPES, 150 mM NaCl, 250 mM imidazole, pH 7.3 collecting 50 \u00b5L fractions.</p><p>The eight surface cysteines on M9-\u03b2Gal-8C and four surface cysteines on Imp \u237a should be efficiently labeled with a 150- and 70-fold molar excess of Atto542 maleimide, respectively.&nbsp;Excess dye is then removed by the same procedure as for the HMSiR dye, except that 5 mL is sufficient for the first ",
    "Wash step.</p><p>&nbsp;</p><p><strong>Cell Culture</strong></p><p>This procedure assumes competence in routine mammalian cell culture techniques.&nbsp;Cells are cultured in McCoy\u2019s 5A (modified) media supplemented with 100 U/mL penicillin-streptomycin, 1 mM sodium pyruvate, 1X MEM non-essential amino acids solution, and 10% (v/v) fetal bovine serum in 5% (v/v) CO<sub>2</sub> enriched air at 37\u00baC.&nbsp;For culture maintenance, cells should be grown to ~95% confluency, and ",
    "Split using Accutase.&nbsp;Cells should be tested monthly for mycoplasma contamination.&nbsp;For microscopy experiments, cells should be ",
    "For these experiments, U-2 OS-CRISPR-NUP96-mEGFP cells should be used.&nbsp;The EGFP tags on the 32 copies of NUP96 within the NPC scaffold provide the necessary binding sites for blinking dye-labeled anti-GFP nanobodies, which provides the stochastic and bright fluorescence needed to ",
    "Generate super-resolution images of individual NPCs.</p><p>&nbsp;</p><p><strong>Agarose Immobilized Fluorescent Beads</strong></p><p>",
    "A slide containing immobilized fluorescent microspheres is used for obtaining calibration and precision data, and should be formed as follows.&nbsp;Into each chamber of a 4-well glass bottomed coverslip (Ibidi, #80447), ",
    "Add 150 \u00b5L of a mixture of 1 \u00b5m and 0.1 \u00b5m Tetraspeck microspheres diluted into autoclaved distilled water [1:40 and 1:1000 dilution (v/v), respectively].&nbsp;Then, 200 \u00b5L of 2% preheated and cleared agarose solution in autoclaved water is added to each chamber and allowed to ",
    "Cool and solidify.&nbsp;The top ",
    "Cover should be sealed with parafilm to prevent the agarose from drying out.&nbsp;This slide with immobilized microspheres can be stored in the microscope room and re-used numerous times.&nbsp;For longer term stability, ",
    "Store in a refrigerator, warming up to room temperature for 15 min before use.</p><p><strong>&nbsp;</strong></p><p><strong>IMAGING PROCEDURES</strong></p><p><strong>",
    "AO",
    "Calibration</strong></p><p><em>(~45 min)</em></p><p>",
    "For an optimal PSF, the AO system needs to be calibrated on the day of the experiment.&nbsp;The aberrations introduced by the imaging optics are corrected using a two-step approach.&nbsp;It is assumed that the optical elements within the AO system are properly aligned.&nbsp;This will be the case if the emission from a 1 \u00b5m fluorescent bead is visible as an array of spots on the WFS.&nbsp;These spots arise from a set of equally-spaced microlenses focusing the beam onto a CCD chip within the Shack-Hartmann WFS.<sup>28</sup>&nbsp;</p><p>1)&nbsp;&nbsp;The first step of the calibration procedure (rough calibration) requires using a software-driven iterative ",
    "Process to alter the shape of the DM until an optimized flat wavefront is obtained (manufacturer-provided software).&nbsp;Physically, this is observed as a correction to the spacing between the spots imaged by the WFS to yield (nearly) identical <em>x</em> and <em>y</em>",
    "distances between the spots.&nbsp;</p><p>2)&nbsp;&nbsp;For the second calibration step (fine tuning), the emission path should be changed to project the emission from a 0.1 \u00b5m bead onto the imaging camera instead of the WFS.&nbsp;A software-driven iterative ",
    "Process is then used to ",
    "Adjust the DM to achieve the highest quality image on the imaging camera (diffraction-limited round spot when in focus), using an algorithm based on an intensity-based merit factor.<sup>29</sup>&nbsp;</p><p>",
    "In practice, the rough calibration is not needed on a daily basis and the image-based calibration is sufficient, but it is good practice to recalibrate with the WFS on a regular basis (e.g., weekly).&nbsp;With an optimized PSF, the astigmatism needed (we use 60 nm rms astigmatism) is added to the calibrated DM settings, and the sample is then imaged.</p><p><strong>&nbsp;</strong></p><p><strong>Cell Preparation for Imaging</strong></p><p><em>(~10 min)</em></p><p>",
    "When ready to begin imaging experiments, mount the coverslip with cells grown overnight into the aluminum holder and create ",
    "Flow chambers, as described under Imaging System (Sample Chambers):</p><p>1)&nbsp;&nbsp;Permeabilize the cells by incubating with 40 \u00b5g/mL digitonin in ",
    "Import buffer (IB; 20 mM HEPES, 110 mM KOAc, 5 mM NaOAc, 2 mM MgOAc<sub>2</sub>, 1 mM EGTA, pH 7.3) for 2 min.&nbsp;<u>Note:</u>&nbsp;the timing is important here, as the nuclei will swell significantly without osmotic balance, possibility even filling the entire cytoplasmic compartment.&nbsp;</p><p>2)&nbsp;&nbsp;Wash the permeabilized cells once with 10 \u00b5L IB + 1.2% (w/v) PVP (IB-PVP).&nbsp;<u>Note:</u>&nbsp;the 1.2% PVP provides the necessary osmotic balance to prevent the nuclei from swelling (and must be a high molecular weight PVP to prevent diffusion through NPCs).&nbsp;The percentage used can vary depending on cell line.&nbsp;This can be checked by adding different percentages of PVP and checking whether the nuclei swell, shrink, or stay the same size.</p><p>3)&nbsp;&nbsp;Add 10 \u00b5L of 100 nM LaG-9(S151C-HMSiR) in IB-PVP to the permeabilized cells, and ",
    "Incubate for 3 min.</p><p>4)&nbsp;&nbsp;Wash the cells twice with 10 \u00b5L IB-PVP.</p><p>The cells are now ready for experiments, and should be used within ~5 min.&nbsp;The time clock for ",
    "Import experiment begins when the appropriate transport ",
    "Mix is added.</p><p><strong>&nbsp;</strong></p><p><strong>NPC Data Acquisition</strong></p><p><em>(~20 min)</em></p><p>While the NPCs in the permeabilized cell system are initially highly stabilized on the nanoscale, the ideal imaging window is the first 15-20 min after the nanobody decoration step, as the nuclei will begin to jiggle and detach from the surface at around 30-45 min.&nbsp;To this end, it is important to be prepared to initiate the ",
    "Import reaction shortly after the nanobody ",
    "Wash step by adding the desired transport mix, which should ",
    "Include the desired concentration of nuclear transport receptors (NTRs; e.g., Imp \u237a, Imp \u03b21, or Imp \u03b22), cargo (e.g., NLS-2xBFP or M9-\u03b2Gal-8C), NTF2 (the transport receptor for RanGDP<sup>30</sup>), RanGDP, and GTP in IB.",
    "Suggested concentrations are 0.5-2 \u00b5M for NTRs, RanGDP, and cargos, 1 mM for GTP, and 1 nM for the fluorescently labeled (tracked) protein (",
    "See associated publication).</p><p>1)&nbsp;&nbsp;When ready, the transport ",
    "Mix (~10 \u00b5L) is flowed into the desired chamber with the nanobody-decorated NPCs.&nbsp;</p><p>2)&nbsp;&nbsp;To allow the sample to stabilize and the RanGTP/RanGDP gradient to be established across the nuclear envelope, image acquisition should be delayed for ~1 min.<sup>31</sup>&nbsp;Image sequences for NPC localizations (red channel, ~8 min total time; e.g., fourteen 500-frame movies with a 5 s gap between movies, 50 ms/frame, \u03bb<sub>ex </sub>= 647 nm, 3 kW/cm<sup>2</sup>) and cargo translocation (green channel, ~2 min total time; e.g., fifty 1000-frame movies, 2-3 ms/frame, \u03bb<sub>ex </sub>= 532 nm, 50-100 kW/cm<sup>2</sup>) should then be sequentially acquired.&nbsp;</p><p>Acquisition of the two ",
    "Separate colors can occur in either order.&nbsp;A major advantage of the AO system is that any chromatic aberrations (different colors focusing at different points along the optical axis) can be compensated by applying an appropriate defocus when switching channels (in our system, a 30 nm rms defocus is used).&nbsp;Applying such a defocus is recommended so that the precisions within the two color channels scale similarly.&nbsp;If the green channel is imaged first, note that higher 532 nm excitation intensities required for faster image acquisition will result in some photobleaching of the HMSiR dye.&nbsp;If the red channel is imaged first, background fluorescence from inside the nucleus from already imported molecules can be expected, which will likely require photobleaching before the signal-to-noise ratio is high enough to ",
    "Obtain data with an acceptable signal-to-background ratio.</p><p>&nbsp;</p><p><strong>Data for <em>z</em>-Calibration and Image Alignment</strong></p><p><em>(15 min)</em></p><p>Immediately after acquiring cargo transport and NPC localization data, image sequences necessary to ",
    "To better sample the field, one bead should be imaged near the origin, and one bead imaged in each quadrant.&nbsp;For larger imaging fields, an alternate sampling strategy involving more beads may be necessary.</p><p>Remember to ",
    "Apply any necessary chromatic defocus when imaging channels are switched.</p><p>&nbsp;</p><p><strong>Data for <em>xyz</em>",
    "Precision</strong></p><p><em>(1 hr)</em></p><p>Image sequences of 0.1 \u00b5m beads such as those described earlier for calculating the image alignment matrix should be collected for a range of <em>z</em> positions (e.g., 0\u00b1300 nm) and photon intensities (e.g., 1000-4000 photons/spot).&nbsp;Images at multiple tens of different <em>z</em> positions are recommended collected with at least two distinct photon levels.  ",
    "These data for determining precision need to be collected only once, whereas the <em>z</em>-calibration and image alignment data need to be collected for every nucleus.&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>DATA ANALYSIS</strong></p><p>",
    "These analyses will require a series of Matlab scripts (identified with quotation marks, \u201c\u201d), which are available from Github (<a href=\"https://github.com/npctat2021/npc3d2021\" rel=\"noopener noreferrer\" target=\"_blank\">https://github.com/npctat2021/npc3d2021</a>) and described in <strong>NCB Supplementary Table 1</strong>.&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>Spot Identification and 3D Localization</strong></p><p><em>(For each nucleus, ~10 min for the NPC scaffold and ~6 hr for the cargo complexes)</em></p><p>The first stage of data analysis requires determining the <em>x</em>, <em>y</em>, and <em>z</em> coordinates of the single particle spots recorded in the image sequences of interest.&nbsp;Obtaining these coordinates is readily accomplished using Fiji (a bundled package of ImageJ including numerous plugins for image analysis)<sup>32</sup> with the ThunderSTORM<sup>33</sup> plug-in.&nbsp;The maximum likelihood (MLE) method is recommended for determining all single molecule localizations.&nbsp;A <em>z</em>-calibration curve is first obtained from the <em>z</em>-stack images of 0.1 \u00b5m beads obtained after the nuclear ",
    "Import data was collected.&nbsp;Since the astigmatism introduced by the DM results in elongation of the spot intensity along <em>x</em> or <em>y</em>",
    "depending on <em>z</em> position, fitting the distribution of the differences in the spot widths in <em>x</em> and <em>y</em> as a function of <em>z</em> yields a <em>z</em>-calibration curve (<strong>NCB Figures 1d,e</strong>).<sup>21</sup>&nbsp;The ThunderSTORM plug-in calculates this calibration curve from an in",
    "Put <em>z</em>-stack of images of beads using a revised algorithm.&nbsp;With",
    "this <em>z</em>-calibration curve, the <em>x</em>, <em>y</em>, and <em>z</em> coordinates of particle positions in the nuclear ",
    "Import datasets can be generated.&nbsp;</p><p>1)&nbsp;&nbsp;Open the calibration <em>z</em>-stack image ",
    "Sequence (in a single file) in Fiji.&nbsp;Under the \u2018Thunder STORM\u2019 plugin, click on \u20183D calibration\u2019.&nbsp;Set to \u2018no filter\u2019, \u2018local maximum\u2019, \u2018maximum likelihood\u2019, \u2018ThunderSTORM\u2019 defocus model, and other parameters as appropriate.&nbsp;Click \u2018OK\u2019, and ",
    "Save the calibration file.</p><p>2)&nbsp;&nbsp;Open the image ",
    "Sequence to ",
    "Analyze in Fiji.&nbsp;Under the \u2018Thunder STORM\u2019 plugin, click on \u2018Run analysis\u2019.&nbsp;Set to \u2018no filter\u2019, \u2018local maximum\u2019, \u2018PSF: Elliptical Gaussian (3D astigmatism)\u2019, \u2018maximum likelihood\u2019, and other parameters as appropriate.&nbsp;The calibration file needed is the one generated in step 1.&nbsp;Click",
    "\u2018OK\u2019, and the \u2018ThunderSTORM:results\u2019 out",
    "Put window will appear.</p><p>3)&nbsp;&nbsp;In the \u2018ThunderSTORM:results\u2019 out",
    "Re",
    "Move duplicates\u201d script to eliminate those localizations that are too ",
    "Close (uncertainty thres",
    "Hold set to 5 nm).&nbsp;<u>For the NPC scaffold (nanobody) data:</u>&nbsp;Run",
    "the \u201cdensity filters\u201d script to eliminate those localizations in low density areas, i.e., between clustered localizations (minimum of 10 localizations in a cylinder with a 110 nm radius) arising from individual NPCs.&nbsp;</p><p>4)&nbsp;&nbsp;After filtering, the minimum information needed will be the spot centroids (<em>x</em>, <em>y</em>, and <em>z</em> coordinates), the spot widths in <em>x</em> and <em>y</em>, the number of photons/spot, and the frame number in the image sequence.&nbsp;This information is exported to a .csv file (that can be opened in Microsoft Excel) to be used for subsequent analysis.</p><p>&nbsp;</p><p><strong>Precision</strong></p><p><em>(1-2 hr)</em></p><p>1)&nbsp;&nbsp;Calculate the <em>xyz</em> precision as follows.&nbsp;Using ThunderSTORM, ",
    "Determine the <em>x</em>,<em> y</em>, and <em>z</em> coordinates of 0.1 \u00b5m beads in the 100 frame image sequences collected earlier at different <em>z</em>",
    "positions.&nbsp;Then, ",
    "Calculate the standard deviation of the ",
    "Position measurements.&nbsp;These standard deviations of the measured positions in <em>x</em>,<em> y</em>, and <em>z</em> are the estimated precisions in <em>x</em>,<em> y</em>, and <em>z</em>.</p><p>3)&nbsp;&nbsp;Plot the <em>x</em>,<em> y</em>, and <em>z</em> precisions as a function of <em>z</em>",
    "position.&nbsp;Since precision scales by (1/<em>N</em><sub>p</sub>)<sup>1/2</sup>, where <em>N</em><sub>p</sub> is the number of photons collected, the measured precision should be scaled to a standard value by multiplying the precision obtained for each particle by (<em>N</em><sub><em>p</em></sub>/<em>N</em><sub>r</sub>)<sup>1/2</sup>, where <em>N</em><sub>r</sub> is the reference photon level.&nbsp;We typically calibrated precision curves to 3000 photons (<strong>NCB Figure 1f</strong>), the minimum photon level arising from the fluorescence of single molecules of HMSiR used to ",
    "Generate the NPC scaffold.</p><p>&nbsp;</p><p><strong>Image",
    "Alignment</strong></p><p><em>(30 min)</em></p><p>",
    "A reference channel needs to be determined, and all coordinates transformed into this coordinate system.&nbsp;In the following, we assume that the red channel (NUP96-nanobody localizations) is the reference, and that the green channel (cargo complex localizations) coordinates must be converted to the red channel coordinate system.&nbsp;This was accomplished by applying two successive corrections to the green channel coordinates, first to <em>x</em> and <em>y</em>",
    "and then to <em>z</em>.</p><p><em>&nbsp;</em></p><p><em>Image Alignment in x and y</em></p><p>1)&nbsp;&nbsp;The mean <em>x</em> and <em>y</em>",
    "coordinates of the 0.1 \u00b5m beads in the 100-frame images sequences recorded earlier should be obtained with ThunderSTORM for both color channels.</p><p>2)&nbsp;&nbsp;The <em>xy</em> alignment matrix to ",
    "Transform the <em>x</em> and <em>y</em>",
    "green channel coordinates into red channel coordinates is obtained as described earlier,<sup>34</sup> using rotational and translational corrections.&nbsp;This is accomplished by using a non-linear least-squares fitting routine (Matlab script \u201cgreen2red_transfer_matrix\u201d) to ",
    "Determine the best angular and translational corrections to convert the set of green channel coordinates into a corresponding set of red channel coordinates.&nbsp;</p><p>3)&nbsp;&nbsp;Calculate the standard deviation of the differences between the transformed green channel coordinates and the measured red channel coordinates.&nbsp;This standard deviation is defined as the alignment precision in <em>x</em> and <em>y</em>.&nbsp;For our system, these were typically ~0.1-2 nm for both <em>x</em>",
    "and<em> y</em>.&nbsp;For some optical systems, particularly those with larger imaging areas, a larger number of alignment points and/or a more complex alignment algorithm may be needed.</p><p>&nbsp;</p><p><em>Image Alignment in z</em></p><p>",
    "While the AO is used to roughly ",
    "Align the <em>z</em>-focus of the two imaging channels, accurate alignment in <em>z</em> requires the use of distinct <em>z</em>-calibration curves for the two color channels, and an estimate of the distance between these two approximately parallel curves.&nbsp;As discussed in the Spot Identification and 3D Localization section, ThunderSTORM calculates the <em>z</em>-calibration curve from in",
    "Put image stacks; the out",
    "and <em>y</em> spot width curves (<strong>",
    "NCB",
    "Figure 1d</strong>).&nbsp;The difference between these crossing points for the two channels in the laboratory <em>z</em> coordinate needs to be estimated to ",
    "Align the images in <em>z</em>.&nbsp;</p><p>1)&nbsp;&nbsp;Calculate the average difference in the mean <em>z</em>-",
    "Position in the laboratory frame for the 0.1 \u00b5m beads in the 100-frame images sequences recorded earlier for both color channels.",
    "This average difference in mean <em>z</em>-",
    "Position is the correction needed to convert the <em>z</em>-coordinate in the green channel to the <em>z</em>-coordinate in the red channel.</p><p>2)&nbsp;&nbsp;Calculate the standard deviation of the difference in mean <em>z</em>-position.&nbsp;This value is considered to be the <em>z</em>-alignment precision.&nbsp;For our system, this was typically ~3-7 nm.</p><p>&nbsp;</p><p><strong>Double Ring Structure of the NPC Scaffold</strong></p><p><em>(1 hr per nucleus)</em></p><p>The fluorescent spots obtained from the HMSiR-labeled nanobody should yield recognizable clusters, which are individual NPCs.&nbsp;To ",
    "Obtain an averaged double-ring structure of the NPC scaffold, the data are curated and analyzed as described below.&nbsp;The starting in",
    "Put data is an Excel spreadsheet (\u201craw image data.csv\u201d) that minimally has four columns (the <em>x</em>,<em> y</em>, and <em>z</em> coordinates and the photon counts) for the fluorescence spots as identified through ThunderSTORM analysis.&nbsp;The row numbers correspond to frame numbers.&nbsp;Matlab scripts are identified with quotation marks (\u201c\u201d).</p><p>1)&nbsp;&nbsp;Run",
    "\u201cphotonandz_filter\u201d to ",
    "Filter out only those localizations with <em>z</em> = 0\u00b1300 nm, and for which the photon ",
    "Count is \u2265 3000.</p><p>2)&nbsp;&nbsp;Use",
    "\u201ccircular_roi\u201d to ",
    "Select clusters (\u2265 10 localizations) based on reasonable roundness and size (i.e., located within a circular <em>xy</em> diameter = 60-150 nm).</p><p>3)&nbsp;&nbsp;Extract the coordinates and photon counts of individual clusters into ",
    "Separate text files using \u201cseparate_pores\u201d.</p><p>4)&nbsp;&nbsp;Fit the localizations in each of the individual clusters to a double circle model using \u201cestimate_cylinder\u201d, which yields the centroid (<em>x</em>, <em>y</em>, <em>z</em>), the diameter of the circles (both the same) and the distance between the circles (height of the scaffold).&nbsp;This model assumes that the NPCs are not tilted from the <em>z</em> axis.</p><p>5)&nbsp;&nbsp;Run \u201cselect_pores\u201d to identify those clusters having at least 10 points with a diameter of 80-135 nm, a height of 40-65 nm, and a <em>z</em>-center of 0\u00b1200 nm, as determined by the double-circle ",
    "Fit algorithm (\u201cestimate_cylinder\u201d).</p><p>6)&nbsp;&nbsp;To ",
    "Re",
    "Move outliers, ",
    "Run \u201ccirclefit_bisquare\u201d.&nbsp;This script first fits all cluster localizations to a circle in the <em>xy</em>-plane (i.e., ignoring the <em>z</em> coordinate).&nbsp;Then, this script calculates the mean <em>xy</em> distance to the circle for all localizations (residuals), as well as the standard deviation of the residuals, and eliminates those localizations whose residual is more than two standard deviations of the residuals.&nbsp;In practice, very few clusters should have points eliminated by this circle fitting process.&nbsp;If any points are eliminated from a cluster, the \u201cestimate_cylinder\u201d and \u201cselect_pores\u201d scripts should be re-",
    "Extract the 8-fold rotational symmetry of the NPC scaffold, the individual NPC data used to ",
    "Generate the unrotated scaffold needs to be rotated by a phase angle before aligning all the clusters.&nbsp;The assumed 8-fold rotational symmetry predicts an oscillating intensity within the scaffold rings with a period of 45\u00ba.&nbsp;There are insufficient data points within individually localized clusters to establish this pattern within the entire ring.&nbsp;Instead, the periodic nature of the expected localizations is taken advantage of by determining the angle of each point in a cluster (NPC) relative to the relevant com",
    "Pass point (0\u00b0, 45\u00b0, 90\u00b0, 135\u00b0, etc.) assuming clockwise rotation around the centroid (the <em>z</em> coordinate is ignored).&nbsp;The phase angle is then determined from this compressed angular dataset.</p><p>1)&nbsp;&nbsp;Identify the quadrant for the angle of each localization using \u201cpore_rotation_step1\u201d, which identifies the angles as 0-90\u00ba.&nbsp;Then, subtract 45\u00b0 from the angles &gt; 45\u00b0 using \u201cpore_rotation_step2\u201d, generating a set of angles 0-45\u00ba.</p><p>2)&nbsp;&nbsp;Generate the angle distribution histogram (0-45\u00ba) of the localizations in each cluster with a bin of 5\u00ba using \u201cpore_rotation_step3\u201d.</p><p>3)&nbsp;&nbsp;Estimate the phase angle of the cluster using \u201cpore_rotation_step4_fitting\u201d to ",
    "Fit the angle distribution histogram to a sinusoidal function with a period of 45\u00b0 and a variable phase.</p><p>4)&nbsp;&nbsp;Translate the center (centroid) of each cluster to the origin using \u201ccentering_pore_step5\u201d.</p><p>5)&nbsp;&nbsp;Rotate every point in a cluster about its centroid by the estimated phase angle using \u201cpore_rotation_step6\u201d.</p><p>6)&nbsp;&nbsp;Merge the rotated clusters using \u201cmerge_after_rotation_step7\u201d.&nbsp;The result is the rotated NPC scaffold.</p><p>&nbsp;</p><p><strong>Alignment of Cargo Localizations with NPCs</strong></p><p><em>(~20 min per nucleus)</em></p><p>Having determined the location and relative orientation of individual NPCs, the fluorescent spots obtained from cargo complexes undergoing transport can be aligned with those NPCs.&nbsp;The starting in",
    "Put data is an Excel spreadsheet (e.g., \u201call green spots.csv\u201d) that has a minimum of four columns (the <em>x</em>,<em> y</em>, and <em>z</em> coordinates and the photon counts) of the fluorescence spots obtained through ThunderSTORM analysis.&nbsp;The row numbers correspond to frame numbers.</p><p>1)&nbsp;&nbsp;Curate the dataset with \u201cphoton_based_filter\u201d, which retains only those localizations for which the number of photons collected was \u2265 1000.</p><p>2)&nbsp;&nbsp;Transform the <em>x</em>,<em> y</em>, and<em> z </em>coordinates into red channel coordinates using \u201cgreen_localization_in_red_channel\u201d using the previously calculated image alignment matrix.</p><p>3)&nbsp;&nbsp;Identify all cargo localizations within a 400 nm cube centered on an NPC centroid using \u201ctrack_localize_whole_roi\u201d.</p><p>4)&nbsp;&nbsp;Align the cargo localizations into the averaged NPC scaffold via <em>xyz</em> translation and then rotation based on the pore that they are closest to (the 400 nm cube) using \u201ccentering_tracks_wrt_whole\u201d and \u201ctrack_rotation_in_whole\u201d.</p><p>&nbsp;</p><p><strong>",
    "Analysis and Identification of Trajectories</strong></p><p><em>(variable time, depending on experimental question; ~1.5 hr for trajectory categorization per nucleus)</em></p><p>Having aligned the cargo complex localizations with the averaged NPC scaffold, the data can then be analyzed as desired.&nbsp;Cargo localizations found in multiple successive frames associated with the same NPC can be assumed to represent the same molecule.&nbsp;We defined trajectories as three or more consecutive localizations.&nbsp;Three consecutive localizations is the minimum number needed to define import, abortive import, ",
    "Export and abortive export, as such categorization requires knowing the initial and eventual compartment as well as confirming that the molecule was bound to the NPC.&nbsp;We separated trajectories into such categories manually.</p>"
]