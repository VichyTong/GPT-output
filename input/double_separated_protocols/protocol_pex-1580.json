[
    "<p><strong><u>1.",
    "Plasmid construction</u></strong></p><p><strong>1.1&nbsp;Plasmid preparation for the general tem",
    "Plate of the kinase biosensor</strong></p><p>1)&nbsp;&nbsp;Amplify gene fragments, including an enhanced cyan fluorescent protein (ECFP), a bacterial beta-galactosidase gene (LacZ), a derivative of yellow fluorescent protein (YPet), EV linker (116 amino acids) <sup>2</sup>, and a kinase domain (active/dead Fyn kinase or ZAP70 kinase) by polymerase chain reaction (PCR) using Q5 DNA polymerase.</p><p>2)&nbsp;&nbsp;Ligate each gene fragment into the pSin lentiviral ",
    "Transfer vector between SpeI and EcoRI with T4 ligase.",
    "Several restriction sites are introduced as shown in Figure 1a.",
    "The final product is called pSin-ELYK, where E, L, Y, and K stand for ECFP, LacZ, YPet, and kinase domain, respectively (Figure 1a).</p><p>3)&nbsp;&nbsp;Transform the ligation product to DH5\u03b1 with the mixture of IPTG and X-Gal, and ",
    "Seed cells onto the LB agar ",
    "Plate with ampicillin at 37\u2103 overnight.</p><p>4)&nbsp;&nbsp;Select only blue colonies for plasmid purification.</p><p>5)&nbsp;&nbsp;Verify the ",
    "Sequence of pSin-ELYK by Sanger sequencing (GENEWIZ) before use.&nbsp;&nbsp;</p><p>&nbsp;</p><p><strong>1.2 Plasmid preparation for the Fyn self-activating FRET (saFRET) biosensor</strong></p><p>1)&nbsp;&nbsp;Re",
    "Place the \u201cK\u201d domain in pSin-ELYK with the gene fragment of either active or dead Fyn kinase domain using T4 ligase.",
    "</p><p>2)&nbsp;&nbsp;Replace",
    "the \u201cLacZ\u201d domain in pSin-ELYK with the Fyn-specific sensing domain (Figure 1b), including SH2 domain [1], a flexible linker, and a Fyn-specific substrate peptide (EKIEGTYGVV) <sup>8</sup>, using Golden Gate DNA assembly.</p><p>3)&nbsp;&nbsp;Transform the DNA assembly product to DH5\u03b1 with the mixture of IPTG and X-Gal, and ",
    "Seed cells onto the LB agar ",
    "Plate with ampicillin at 37\u2103 overnight.</p><p>4)&nbsp;&nbsp;Select only white colonies for plasmid purification.",
    "</p><p>5)&nbsp;&nbsp;Verify",
    "the ",
    "Sequence of the Fyn saFRET biosensor by Sanger sequencing before use.</p><p><em>&nbsp;</em></p><p><strong>1.3 Activity test of Fyn saFRET biosensors by a western blot </strong></p><p>1)&nbsp;&nbsp;Transfect purified plasmids of Fyn saFRET biosensors to HEK293T cells using Lipofectamin3000.</p><p>2)&nbsp;&nbsp;After",
    "36-48 h of transfection, ",
    "Harvest and lyse cells with lysis buffer.",
    "</p><p>3)&nbsp;&nbsp;Centrifuge cells and ",
    "Collect supernatants.",
    "</p><p>4)&nbsp;&nbsp;Mix supernatants with SDS-PAGE protein loading buffer, boil, and ",
    "Load the solution into SDS-PAGE gel.</p><p>5)&nbsp;&nbsp;Following the general protocol for the western blot, the Anti-GFP antibody is used to target the biosensor, and the Anti-Phosphotyrosine antibody is used to target the phosphotyrosine.",
    "The gel image is taken by the gel documentation.&nbsp;</p><p><br></p><p><strong>1.4 Activity test of Fyn saFRET biosensors by a fluorescent microscope </strong></p><p>1)&nbsp;&nbsp;Transfect",
    "purified plasmids of Fyn saFRET biosensors to HEK293T cells using Lipofectamin3000.",
    "</p><p>2)&nbsp;&nbsp;After 36-48 h of transfection, ",
    "Seed transfected cells on a fibronectin-coated glass-bottom dish and culture in 0.5% FBS DMEM medium for 12 h before being subjected to the inhibitor stimulation (such as 10 \u00b5g/mL of PP1 for Fyn kinase).&nbsp;</p><p>3)&nbsp;&nbsp;The detailed experiment for imaging the activity of the biosensor in response to the PP1 is described in \u201cMicroscopy, Image Acquisition, and quantification\u201d.&nbsp;</p><p><br></p><p><strong>&nbsp;<u>2.",
    "Biosensor Library Construction</u></strong></p><p>Four libraries are used for optimizing the FRET biosensor of a specific kinase (Figure 2).</p><p>1.&nbsp;&nbsp;&nbsp;There are two substrate libraries for FRET biosensor with active kinase domain (KA):</p><p>       -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lib1-KA contains mutations on three amino acid residues upstream of the consensus tyrosine residue (Y) of the wild-type substrate (XXXY, where X represents any amino acid)",
    "</p><p>       -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lib2-KA contains mutations on three amino acid residues downstream of the consensus tyrosine residue (Y) of the wild-type substrate (YXXX, where X represents any amino acid)",
    "</p><p>2.&nbsp;&nbsp;&nbsp;There are two substrate libraries for FRET biosensor with dead kinase domain (KD):</p><p>       -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lib1-KD (similar to KA library)</p><p>       -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lib2-KD (similar to KA library)</p><p><br></p><p>The procedure for constructing these FRET biosensor libraries is described below:</p><p>1)&nbsp;&nbsp;The tem",
    "Plate for generating the biosensor library containing substrate variants is the sensing domain (Figure 1b).",
    "</p><p>2)&nbsp;&nbsp;Use",
    "a pair of primers to ",
    "Generate the substrate libraries, including the forward primer targeting specific DNA sequences on the 5\u2019-end of the sensing domain and the reverse primer with the NNK de",
    "</p><p>For example, there are three primers for generating Fyn biosensor libraries:</p><p>  -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A sense primer</p><p>",
    "5\u2019- ATCCCGTCTCACGCCCGCATGCATTGG TATTTTGGGAAGATCACTCGTCGGGAGTC C",
    "-3\u2019</p><p>   -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An antisense primer \u2013 Lib1 <",
    "/p><p> 5\u2019- GGATCGTCTCTTAGAGAGCTCCACGAC GCCGTAMNNMNNMNNGATCTTCTCAGAA",
    "CCCTCACCAGAACCC -3\u2019</p><p>   -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An antisense primer \u2013 Lib2</p><p> 5\u2019- GGATCGTCTCTTAGAGAGCTCMNNMN NMNNGTACGTGCCCTCGATCTTCTCAGA",
    "A CCCTCACCAGAACCC -3\u2019</p><p>3)&nbsp;&nbsp;For the PCR condition, vary the annealing temperature from 55-70\u02daC and set the thermocycling condition at 20 cycles.</p><p>4)&nbsp;&nbsp;Load PCR products of four substrate libraries in 1.5% agarose gel.</p><p>5)&nbsp;&nbsp;Excise gels with the correct size and ",
    "Purify them using Zymo",
    "Clean gel DNA recovery kit.",
    "Each substrate library is prepared in parallel for steps #6-12.&nbsp;</p><p>6)&nbsp;&nbsp;Re",
    "Place the LacZ domain of the pSin-ELYK tem",
    "Plate (Figure 1a) between Esp3I restriction sites with purified DNA fragments (from #5) of the sensing domain containing substrate libraries sites using the Golden Gate assembly.",
    "</p><p>7)&nbsp;&nbsp;Purify and ",
    "Concentrate assembly products using the DNA Clean and Concentrator Kits.</p><p>8)&nbsp;&nbsp;Add purified products (the volume &lt; 2.5 <em>\u03bc</em>L) from #7 to 25 <em>\u03bc</em>L DH10B cells, and then added the mixture into a 0.1 cm cuvette for electroporation by the electroporation system.",
    "&nbsp;</p><p>9)&nbsp;&nbsp;Re",
    "Cover electroporated cells in ",
    "Warm SOC medium at 37\u2103 for 1 h.</p><p>10)&nbsp;&nbsp;&nbsp;Transfer cells to 250 mL LB medium with ampicillin and culture at 37\u2103 for 12 h. </p><p>11)&nbsp;&nbsp;&nbsp;Collect cells from cell culture and ",
    "Extract the plasmids using Qiagen HiSpeed Plasmid Maxi kit.",
    "The purified plasmids are stored in 1 mL nuclease-free water at -20\u2103.</p><p>12)&nbsp;&nbsp;&nbsp;Verify the plasmids containing substrate libraries by Sanger sequencing, western blotting, and imaging before use.</p><p><strong>&nbsp;</strong></p><p><strong><u>3.",
    "Generation of mammalian cell library</u></strong></p><p><strong>3.1 Production of virus</strong></p><p>1)&nbsp;&nbsp;Seed 5\u2a2f10<sup>6</sup> of Lenti-X 293T cells in 100-mm cell culture dish with 10% FBS DMEM medium.</p><p>2)&nbsp;&nbsp;On",
    "the next day, ",
    "Re",
    "Place the medium with the fresh medium 3-6 h before transfection.</p><p>3)&nbsp;&nbsp;Use the ProFection\u00ae mammalian transfection system for transfection.",
    "The mixture of viral packaging plasmids pCMV-\u25b38.9 and pCMV-VSVG, and the pSin plasmid containing biosensor variants are added in the calcium-phosphate reagent from the Profection system.",
    "Following the provided protocol, the solution is added to Lenti-X 293T cells.",
    "</p><p>4)&nbsp;&nbsp;After 6 h of transfection, ",
    "Re",
    "Place the medium with the fresh medium.",
    "</p><p>5)&nbsp;&nbsp;After",
    "48 h of transfection, ",
    "Collect the medium containing virus particles, ",
    "Filter them through 0.45\u00b5m ",
    "Concentrate using PEG-it virus precipitation solution for overnight at 4\u2103.</p><p>6)&nbsp;&nbsp;Centrifuge virus precipitation solution to ",
    "Dissolve the virus pallet with PBS and stored at -20\u2103.</p><p>7)&nbsp;&nbsp;Measure the viral titer by ",
    "Flow cytometry before use.</p><p>&nbsp;</p><p><strong>3.2 Generation of mammalian cells containing biosensor libraries by virus transduction</strong></p><p>1)&nbsp;&nbsp;Seed",
    "2\u2a2f10<sup>6</sup> HEK293T cells in 100-mm cell culture dish with 10% FBS DMEM medium.</p><p>2)&nbsp;&nbsp;On",
    "the next day, ",
    "Re",
    "Place the medium with the fresh medium 6 h before transduction.</p><p>3)&nbsp;&nbsp;Add",
    "the concentrated virus with the MOI (multiplicity of infection) of 0.1 to HEK293T cell culture.",
    "Incubate cells for 36-48 h. </p><p>4)&nbsp;&nbsp;Pass cells to the new cell culture dish when cell\u2019s density reaches about 90% confluence.",
    "Cells are also tested for the transduction efficiency by ",
    "Flow cytometer.",
    "&nbsp;</p><p>Add puromycin to the cell culture medium to allow only library-transduced cells to grow.",
    "&",
    "nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p><br></p><p><strong><u>4.",
    "Mammalian cell library screening by FACS</u></strong></p><p>1)&nbsp;&nbsp;Prepare several control groups of transfected/transduced HEK293T cells 1-2 weeks before sorting.</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plain cells: to differentiate cells with or without fluorescent proteins&nbsp;</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells expressing ECFP: to gate for cells expressing ECFP only &nbsp;</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells expressing YPet: to gate for cells expressing YPet only&nbsp;</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells expressing both ECFP and YPet: to gate for cells expressing intermolecular FRET signal</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mixture of cells expressing either ECFP or YPet: to use as a negative gating of FRET signal</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells expressing the wild-type FRET biosensors with active kinase domain (KA): to gate for the active conformation of FRET biosensor (the high FRET ratio gate)</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells expressing the wild-type FRET biosensors with dead kinase domain (KD): to gate for the inactive conformation of FRET biosensor (the low FRET ratio gate)</p><p>2)&nbsp;&nbsp;On the day of sorting, ",
    "Collect seven groups of cells in #1 and re",
    "Suspend them in PBS with 5% BSA.",
    "They are used to create gating profiles for cell sorting in the BD FACS Aria II Cell Sorter.",
    "The information about excitation and emission of FACS is shown below.",
    "</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For ECFP, the excitation wavelength is 405 nm, and the emission ",
    "Filter is 450/50 nm.</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For YPet, the excitation wavelength is 488 nm, and the emission ",
    "</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For FRET signal",
    ", the excitation wavelength is 405 nm, and the emission ",
    "Filter is 545/35 nm.",
    "</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For FRET ratio, it is the ratio of emission of ECFP signal to FRET signal.</p><p>3)&nbsp;&nbsp;Four groups of transduced HEK293T cells containing biosensor libraries, including 1) Lib1-KA, 2) Lib1- KD, 3) Lib2- KA, and 4) Lib2- KD, are used for identifying the kinase biosensor with better performance.",
    "</p><p>4)&nbsp;&nbsp;Before sorting, ",
    "Collect some cells from each group to be used as the \u201cin",
    "Put library\u201d for the high-through",
    "&nbsp;</p><p>5)&nbsp;&nbsp;During sorting, Lib1 with different kinase activity (KA or KD) are sorted by FACS into two groups (e.g. the high- or low-FRET-ratio gates) based on the individual FRET ratio (Figure 3) as shown below.",
    "Each sorted group contained about 1-5\u2a2f10<sup>5</sup>",
    "cells.</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For Lib1 with KA, there are two sorted groups:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -    Lib1-KAH (High FRET ratio with Active Kinase, KA)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -    Lib1-KAL (Low FRET ratio with Active Kinase, KA) <",
    "/p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For Lib1 with KD",
    ", there are two sorted groups:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-    Lib1-KDH (High FRET ratio with Dead Kinase, KD)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-   &nbsp;Lib1-KDL (Low FRET ratio with Dead Kinase, KD)</p><p>6)&nbsp;&nbsp;Similar to Lib1 in step#5, Lib2 with different kinase activity (KA or KD) are also sorted by FACS into two groups (Figure 3).&nbsp;</p><p>7)&nbsp;&nbsp;After sorting, sorted cells are collected in 100% FBS.&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong><u>5.",
    "Illumina DNA sequencing of biosensor variants </u></strong></p><p>1)&nbsp;&nbsp;Extract total RNAs of each non-sorted (<em>In",
    "Put Library</em>) and sorted cell (<em>Sorted Library</em>) using RNeasy Mini Kit.",
    "&nbsp;</p><p>2)&nbsp;&nbsp;Following the provided protocol with some additional step, such as incubating the column with RQ1 RNase-Free DNase to ",
    "Re",
    "Move the genomic DNA.",
    "RNA from each group (from #1) is purified, quantified, and checked its quality by gel electrophoresis.",
    "</p><p>3)&nbsp;&nbsp;Use",
    "the purified total RNA (~500 ng) as a tem",
    "Plate for cDNA synthesis using the SuperScript IV reverse transcriptase with a gene-specific primer.</p><p>4)&nbsp;&nbsp;Add adaptor sequences with different indexes for Illumina sequencing into cDNA by PCR using Q5 DNA polymerase with low PCR cycles (&lt; 16 cycles) as shown in Figure 4. </p><p>5)&nbsp;&nbsp;Load",
    "the individual amplicon library with specific index to 2% agarose gel.",
    "</p><p>6)&nbsp;&nbsp;Excise",
    "the gels with correct size of the library and ",
    "Purify them using Zymo",
    "Clean gel DNA recovery kit.",
    "</p><p>7)&nbsp;&nbsp;Verify",
    "the DNA ",
    "Sequence of purified amplicon libraries by Sanger sequencing and ",
    "Quantify them by Qubit prior to being sequenced by Illumina HiSeq4000 with 50-bp single-end sequencing.</p><p><br></p><p><strong><u>6.",
    "Analysis of sequencing results and selection of biosensors with high sensitivity</u></strong></p><p>1)  Separate FASTQ files from Illumina HiSeq4000 containing the ",
    "Sequence data of the substrate from each library by indexes.</p><p>2)  Check their sequencing qualities using FastQC.",
    "Twelve sequencing data are used for identifying the substrate of the biosensor with better performance.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>3)  ",
    "Extract only ",
    "Sequence data of the substrate domain with the following criteria.&nbsp;</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The sequences must have Phred score &gt; 20 at all positions covering the constant region of the substrate sequence.</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The sequences must contain the \u201cTAC\u201d ",
    "Compute variant enrichment ratios (<em>E</em><sub><em>v</em></sub>) to find the fold enrichment of that variant before (<em>f</em><sub><em>v,input</em></sub>) and after (<em>f</em><sub><em>v,sorted</em></sub>) sorting.",
    "The frequency of a single variant can then be compared between groups in calculating an enrichment ratio <sup>9</sup>.",
    "The enrichment ratio, <em>E</em><sub><em>v</em></sub>, for any single variant, <em>v</em>, is calculated by dividing the frequency of the variant from the selected library, <em>f</em><sub><em>v,sorted</em></sub>, over that from the in",
    "Put control, <em>f</em><sub><em>v,input</em></sub>, according to <em>E</em><sub><em>v </em></sub><em>= f</em><sub><em>v,sorted</em></sub><em> / f</em><sub><em>v,in",
    "The criteria for selecting a biosensor with better performance is that the variants with <em>E</em><sub><em>v</em></sub> &gt; 1 in KAH and KDL groups and &lt; 1 in KAL and KDH groups.</p><p>7)  ",
    "The data for each substrate ",
    "Sequence can be also visualized in the 4D plot using Matlab software.",
    "To achieve better illustration of the 4D-plot, <em>E</em><sub><em>v</em></sub><em> </em>of each group can be further normalized to <em>E</em><sub><em>vn</em></sub> by <em>E</em><sub><em>vn</em></sub> = log (<em>E</em><sub><em>v</em></sub>) when <em>E</em><sub><em>v</em></sub>\uff1e1, and <em>E</em><sub><em>vn</em></sub> = <em>E</em><sub><em>v</em>-1</sub> when <em>E</em><sub><em>v </em></sub>\u2264 1.",
    "These selected sequences with 4D analysis will be further evaluated by their product of <em>E</em><sub><em>v</em></sub> (KAH) and <em>E</em><sub><em>v</em></sub> (KDL) and calibrated with the product of WT biosensor to ",
    "Filter and identify biosensors with the best performance.</p><p><strong>&nbsp;</strong></p><p><strong><u>7.",
    "Microscopy, Image Acquisition, and quantification </u></strong></p><p>1)&nbsp;&nbsp;Construct",
    "the biosensor with the predicted substrate ",
    "Sequence as described in \u201cPlasmid construction\u201d.",
    "Briefly, the substrate of the wild-type sensing domain is replaced by the predicted substrate ",
    "Sequence by PCR with a pair of primers, including:</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The forward primer anneals to the 5\u2019-end of the sensing domain (SH2 domain).",
    "</p><p>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The reverse primer containing the predicted substrate ",
    "Sequence anneals to the 3\u2019-end of the sensing domain (linker and substrate).&nbsp;</p><p>",
    "The sensing domain with new substrate ",
    "Sequence is used to ",
    "Re",
    "Place the LacZ of pSin-ELYK plasmid using Golden Gate assembly (Figure 1).",
    "The assembly product is later transformed, purified, and sequenced by Sanger sequencing before use.",
    "</p><p>2)&nbsp;&nbsp;Transfect",
    "the purified biosensor plasmid into HEK293T cells using Lipofectamine 3000.",
    "</p><p>3)&nbsp;&nbsp;Seed",
    "transfected cells on the fibronectin-coated glass-bottom dish and culture in 0.5% FBS DMEM for 12 h before being subjected to PP1 (10 <em>\u00b5</em>g/mL) stimulation for Fyn. </p><p>4)&nbsp;&nbsp;In",
    "the PP1 ",
    "Wash out experiment\uff0c",
    "Re",
    "Place the medium containing PP1 with normal medium after ",
    "Wash three times.",
    "</p><p>5)&nbsp;&nbsp;Take images with a Nikon Eclipse Ti inverted microscope with a cooled charge-coupled device (CCD) camera with a 420DF20 excitation filter, a 450DRLP dichroic mirror, and two emission filters controlled by a ",
    "Filter changer (480DF30 for ECFP and 535DF35 for YPet).",
    "</p><p>6)&nbsp;&nbsp;Acquire",
    "the time-lapse fluorescence images by MetaMorph 7.8 and the endpoint fluorescence images by MetaFluor 7.8 (Molecular Devices).",
    "The ECFP/FRET ratio images are calculated and visualized with the intensity modified display (IMD) method by Fluocell software<sup>10</sup> (Github <a href=\"http://github.com/lu6007/fluocell\" rel=\"noopener noreferrer\" target=\"_blank\">http://github.com/lu6007/fluocell</a>).",
    "</p><p>7)&nbsp;&nbsp;For data presentation, the normalized values are shown to ",
    "Compare the differences among the experimental groups and to minimize the cell-cell heterogeneity.",
    "The pre-stimulation baseline for each cell is established by averaging the FRET ratio of each cell before stimulation.&nbsp;</p><p><br></p>"
]