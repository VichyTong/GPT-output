[
    "**I. Barcode induction** ",
    "_a) Embryonic mice_",
    "1.",
    "Set up timed matings between _Rosa26<sup>Polylox/Polylox</sup>_ and _Tie2<sup>MCM/+</sup>_ mice.\r\n  ",
    "2.",
    "Nine days after the day of the plug \\(day 0.5), ",
    "Treat pregnant mice by oral gavage with a single dose of 2.5 mg tamoxifen and 1.25 mg progesterone to ",
    "Induce barcoding in the developing embryos at E9.5.",
    "Tamoxifen stock solution is prepared by dissolving 1 g tamoxifen in 4 ml absolute ethanol and 36 ml peanut oil at 55 \u00b0C.",
    "Stock solution can be stored at -20 \u00b0C.\r\n  ",
    "3.",
    "The pups are delivered on E20.5 by caesarean section and raised by foster mothers. \r\n  ",
    "4. Genotype the pups for the _Tie2<sup>MCM</sup>_ allele at 3-4 weeks after birth on genomic DNA prepared from tail biopsies using primers #972, #984 and #HL14.",
    "PCR conditions are as follows: 2 min at 94 \u00b0C; \\(20 s at 94 \u00b0C, 30 s at 62 \u00b0C, 1 min at 72 \u00b0C) 35 times; 5 min at 72 \u00b0C.\r\n  ",
    "5.",
    "Successful tamoxifen induction of _Rosa26<sup>Polylox/+</sup>Tie2<sup>MCM/+</sup>_ mice is tested by PCR amplification of the _Polylox_ locus from genomic DNA of Ficoll-separated peripheral blood leukocytes.",
    "The _Polylox_ PCR is performed with the Expand Long Tem",
    "Plate PCR system using primers #2450 and #2427, annealing at the 5\u2019 and 3\u2019 anchor regions of the _Polylox_ cassette, respectively.",
    "PCR conditions are as follows: 5 min at 95 \u00b0C; \\(30 s at 95 \u00b0C, 30 s at 56 \u00b0C, 5 min at 72 \u00b0C) repeat 35 times; 10 min at 72 \u00b0C.",
    "Separate PCR products by gel electrophoresis.\r\n  ",
    "_b) Adult mice_",
    "1.",
    "Prepare tamoxifen stock solution by dissolving 1 g tamoxifen in 4 ml absolute ethanol and 36 ml peanut oil at 55 \u00b0C.\r\n  ",
    "2. Adult _Rosa26<sup>Polylox/+</sup>Tie2<sup>MCM/+</sup>_",
    "mice are injected intraperitoneally with 1 mg tamoxifen on five consecutive days.\r\n  ",
    "3.",
    "Successful tamoxifen induction of _Rosa26<sup>Polylox/+</sup>Tie2<sup>MCM/+</sup>_ mice is tested by PCR amplification of the _Polylox_ locus as described above \\(Section",
    "Ia 5.)\r\n  ",
    "**II.",
    "Organ preparation**",
    "On the day of analysis, mice are sacrificed by carbon dioxide inhalation.",
    "Peritoneal cells should be harvested by peritoneal lavage before any other abdominal organs are prepared. ",
    "_a) Peritoneal Cavity_",
    "1.",
    "Harvest peritoneal exudate cells by lavage of the peritoneal cavity for 5 times with 2 ml of 5% FACS buffer \\(DPBS with 5% vol/vol FBS).\r\n  ",
    "2.",
    "Small opening and gentle lavage with plastic Pasteur pipettes is helpful to avoid injury and blood cell contamination.\r\n  ",
    "_b)",
    "Spleen_",
    "1.",
    "Take out the spleen and ",
    "Cut the organ into small pieces in 5% FACS buffer using surgical scissors.\r\n  ",
    "2.",
    "To ",
    "Obtain a single cell suspension of splenocytes, the minced spleen is passed through a 40-\u03bcm ",
    "Filter using 5% FACS buffer and the plunger of a 5-ml syringe.\r\n  ",
    "_c)",
    "Bone Marrow_",
    "1.",
    "Prepare femora and tibiae \\(humerus, pelvis and vertebrae can also be included to maximize bone marrow recovery). \r\n  ",
    "2. Bone marrow cells are either flushed from the long bones with 5% FACS buffer, or all bones are crashing in a mortar in 5% FACS buffer. \r\n  ",
    "3. Re",
    "Suspend the extracted bone marrow cells by repeated pipetting and ",
    "Re",
    "Move remaining bone pieces by filtering through a 40-\u03bcm mesh.\r\n  ",
    "**III.",
    "Purification of cells by FACS sorting**",
    "1.",
    "Determine the concentration of the cell suspensions, e.g. on an automated cell counter.",
    "This was done using Cellometer Auto 2000 Cell Viability Counter according to the manufacturer\u2019s protocol.\r\n  ",
    "2.",
    "Block Fc receptors by incubation of the cells \\(5x10<sup>6</sup> cells/50 \u03bcl) for 15 min with 300 \u03bcg/ml whole mouse IgG. \r\n  ",
    "3.",
    "Add cocktails with titrated concentrations of fluorescent dye-labeled antibodies in 5% FACS buffer and ",
    "Stain the cells for 45 min in the dark on ice.",
    "Afterwards, ",
    "Wash cells in an appropriate amount of 5% FACS buffer.\r\n  ",
    "4.",
    "For dead cell exclusion e.g. ",
    "Add 100 nM SYTOX Blue at least 5 min before analysis.\r\n  ",
    "5.",
    "Cell suspensions should be filtered directly to ",
    "Re",
    "Move any cell clumps before being placed on the FACS sorter, e.g. by passing the suspension through the mash of a snap cap cell strainer. \r\n  ",
    "6.",
    "Stained cells are analyzed on a FACSAriaIII cell sorter running BD FACSDiva software and populations of interest are sorted into 20% FACS collection buffer \\(DPBS containing 20% FBS).",
    "Alternatively, cells can directly be sorted into PCR buffer. \r\n  ",
    "7. Aliquots of the sorted cells should be reanalyzed to ",
    "Determine ",
    "Sort purity. \r\n  ",
    "**IV.",
    "PCR amplification of the _**Polylox**_ locus**",
    "_a) From single cells via nested PCR_",
    "1.",
    "By FACS sorting individual cells are deposited into 8-tube PCR stripes containing in each well 25 \u03bcl of 1x PCR buffer supplemented with 12.6 \u03bcg Proteinase K.\r\n  ",
    "2.",
    "Perform lysis for 1 h at 55 \u00b0C, terminate at 95 \u00b0C for 10 min, and ",
    "Cool down to 4 \u00b0C before adding the remaining PCR reagents to a final volume of 50 \u03bcl. \r\n  ",
    "3.",
    "Amplification of the _",
    "Polylox_ cassette is done by nested PCR using the Expand Long Tem",
    "Plate PCR system: \r\n      -",
    "First round PCR: primer #2450 and primer #494 for 5 min at 95 \u00b0C; \\(30 s at 95 \u00b0C, 30 s at 56 \u00b0C, 5 min at 72 \u00b0C) repeat 35 times; 10 min at 72 \u00b0C. ",
    "    ",
    "- Second round PCR: Use 1-2 \u03bcl of the first PCR reaction as tem",
    "Plate and ",
    "Amplify with primers #2426 and #2427 for 5 min at 95 \u00b0C; \\(30 s at 95 \u00b0C, 30 s at 62 \u00b0C, 5 min at 72 \u00b0C) 35 times; 10 min at 72 \u00b0C. ",
    "4.",
    "The nested PCR products are analyzed by gel electrophoresis for product length, and sent for Sanger sequencing \\(e.g.",
    "GATC Biotech).\r\n  ",
    "_b) Cell populations \\(10,000-50,000 cells) by direct PCR_",
    "1.",
    "Sort cells into 1.5 ml Eppendorf tubes containing 300 \u03bcl of 20% FACS buffer. \r\n  ",
    "2. Use 2-5% of the sorted cells for reanalysis and ",
    "Harvest the remaining cells by centrifugation for 5 min at 1500 g and 4 \u00baC. \r\n  ",
    "3.",
    "Turn the tube 180\u00b0 in the rotor and ",
    "Spin again for 5 min at 1500 g.\r\n   ",
    "4.",
    "Carefully ",
    "Re",
    "Move the supernatant and re",
    "Suspend with 25 \u03bcl lysis buffer \\(1x PCR buffer 1 from the Expand Long Tem",
    "Plate PCR system in water and 12.6 \u03bcg Proteinase K).",
    "Digest at 55 \u00b0C for 1 hour and terminate the reaction at 95 \u00b0C for 10 min. DNA can be at -20 \u00b0C, but the experiment should continued swiftly.\r\n  ",
    "5.",
    "PCR amplification of the _Polylox_ locus is as described above \\(Section",
    "Ia 5.)\r\n  ",
    "6.",
    "Visualize PCR products \\(one third of the PCR reaction) by gel electrophoresis.\r\n  ",
    "_c)",
    "Cell populations \\(>50,000 cells) via phenol-chloroform DNA extraction_",
    "1.",
    "Sort cells into 2 ml 20% FACS collection buffer and ",
    "Harvest the cell ",
    "Pellet by ",
    "Centrifuge at 400 g for 10 min after reanalysis for ",
    "Sort purity.\r\n  ",
    "2. Carefully ",
    "Re",
    "Move the supernatant leaving 50-100 \u03bcl of the supernatant to avoid disturbing of the cell pellet. \r\n  ",
    "3. Re",
    "Suspend the ",
    "Pellet in 500 \u03bcl freshly prepared proteinase K-solution \\(10 mM Tris-HCl pH 8, 5 mM EDTA, 1% SDS, 0.3 M Na-acetate, 0.2 mg/ml proteinase K) and incubated at 37 \u00b0C for at least 3 hours.\r\n  ",
    "4.",
    "From the lysate, ",
    "Purify genomic DNA by phenol-chloroform extraction.",
    "Briefly, ",
    "Extract once with an equal volume of a 1:1 mixture of phenol and chloroform.",
    "Then ",
    "Extract the aqueous phase at least twice with an equal volume of chloroform.",
    "Precipitate the DNA by adding 1/10 volume of Na-acetate \\(3M) pH 5 and 1 volume of isopropanol and 5-20 \u03bcg glycogen for 1 hour at \u201320 \u00b0C.",
    "Spin at 16000 g for 10 min and ",
    "Wash the DNA ",
    "Pellet twice with 75% ethanol.",
    "Dissolve the air-dried ",
    "Pellet in water.",
    "Measure DNA concentration.\r\n  ",
    "5.",
    "The _",
    "Polylox_ cassette is readily amplified from 100-200 ng of tem",
    "Plate DNA \\(representing 1.7 - 3.5 x10<sup>4</sup> cells) by PCR using the conditions described above \\(Section Ia 5.)\r\n  ",
    "6.",
    "PCR products \\(one third of the PCR reaction) are observed by gel electrophoresis.\r\n  ",
    "**V. _**Polylox**_",
    "Sequencing**",
    "_a)",
    "Sanger sequencing from single cells_",
    "_",
    "Polylox_ amplicons from single cells were sequenced by primer walking, using a commercial service \\(e.g.",
    "GATC biotech, Germany).",
    "PCR products were either purified by QIAquick PCR Purification Kit, or DNA ",
    "Clean up was done by the provider of the sequencing service.",
    "_b) SMRT sequencing from cell populations_",
    "1. Use the entire PCR product that is left after gel electrophoresis for an initial AMPure PB bead ",
    "Clean up step.",
    "Perform according to the manufacturer\u2019s protocol.\r\n  ",
    "2.",
    "For quality control ",
    "Determine DNA concentration by Qubit measurement and ",
    "Perform a Bioanalyzer ",
    "Run according to the manufacturers\u2019 protocols.\r\n  ",
    "3. Continue library preparation for PacBio SMRT sequencing according to the \u201cAmplicon Tem",
    "Plate Preparation and Sequencing\u201d protocol released by the company.\r\n  ",
    "http://www.pacb.com/wp-content/uploads/Procedure-Checklist-Amplicon-Template-Preparation-and-Sequencing.pdf",
    "4.",
    "Perform primer annealing and polymerase binding according to the manufacturer\u2019s protocol.\r\n  ",
    "5. Load the library by Magbead mode \\(PacBio RS II) or diffusion mode \\(PacBio Sequel) for SMRT sequencing.",
    "We usually recorded for 4 hours. \r\n  ",
    "**VI.",
    "Barcode identification**",
    "The SMRT sequencing yields data files with CCS reads.",
    "The following part explains the retrieval of _Polylox_ barcodes from PacBio CCS Reads \\(RPBPBR). ",
    "_a) Software and hardware_",
    "\u2022 Data \\(PacBio CCS reads, either in fasta or fastq format)",
    "\u2022 _",
    "Polylox_ adapters and segments \\(provided in the data folder of RPBPBR toolkit)",
    "\u2022",
    "Bowtie2 software \\(http://bowtie-bio.sourceforge.net/bowtie2/index.shtml)",
    "\u2022 SAMtools \\(http://www.htslib.org/)",
    "\u2022 RPBPBR toolkit \\(https://github.com/sunlightwang/RPBPBR) ",
    "\u2022 Hardware: Computer running either Linux or Mac OS X \\(10.6 Snow Leopard or later; at least 4 GB of RAM \\(8 GB per core preferred)",
    "; at least quad-core CPU",
    "\u2022 Perl \\(https://www.perl.org/ ) by default already installed in Linux or Mac OS X computers",
    "_b) Software setup_",
    "Commands given in the protocol are runnable at the UNIX shell prompt, which are prefixed with a \u2018$\u2019 character. ",
    "_",
    "To install the SAMtools_, down",
    "Load the SAMtools \\(http://www.htslib.org/download/) and un",
    "Pack the SAMtools tarball: ",
    "$ tar jxvf samtools-1.5.tar.bz2 \u2028",
    "Then cd to the SAMtools source directory and build the samtools binary",
    "$ cd samtools-1.5\u2028",
    "$ ./configure --prefix=/path/to/install",
    "$ make",
    "$ make install",
    "Copy the samtools binary to some directory in your PATH \\(e.g.",
    "$HOME/bin):\u2028",
    "$ cp samtools $HOME/bin\u2028",
    "Or ",
    "Add the directory containing samtools binary to your PATH environment variable",
    "$ ",
    "Export PATH=/path/to/install/bin:$PATH ",
    "_",
    "To install Bowtie2_, down",
    "Load the latest binary package for Bowtie2 \\(https://sourceforge.net/projects/bowtie-bio/files/bowtie2/) and un",
    "Pack the Bowtie2 zip archive:",
    "$ unzip bowtie2-2.3.2-legacy-macos-x86_64.zip",
    "Copy the Bowtie executables to a directory in your PATH \\(e.g.",
    "$HOME/bin):\u2028",
    "$ cd bowtie2-2.3.2-legacy",
    "$ cp bowtie2* $HOME/bin ",
    "Or ",
    "Add the directory containing bowtie2 binaries to your PATH environment variable",
    "$ ",
    "Export PATH=/path/to/bowtie2/binary/directory:$PATH ",
    "_",
    "To install RPBPBR toolkit_, clone the latest binary package from RPBPBR github site \\(https://github.com/sunlightwang/RPBPBR/) ",
    "$ git clone https://github.com/sunlightwang/RPBPBR.git",
    "Add the directory containing RPBPBR binaries to your PATH environment variable",
    "$ ",
    "Export PATH=/path/to/RPBPBR/bin/:$PATH ",
    "_c) Procedure\u2028_",
    "_",
    "To ",
    "Run RPBPBR on the example data files_, cd to the RPBPBR example directory",
    "$ cd /path/to/RPBPBR/example",
    "Then execute RPBPBR on each example file:  ",
    "$ RPBPBR test1.fastq test1 fastq",
    "$ RPBPBR test2.fa test2 fasta",
    "RPBPBR takes PacBio CCS reads \\(in either fasta or fastq format) and directly reports the number of barcodes in the PacBio library of interest for downstream analysis.",
    "By default, RPBPBR takes 4 cores per process; however, the number of cores is adjustable in the script.",
    "Using 4 cores, the running time of RPBPBR varies from < 1 hour to several hours depending on the amount of reads to be processed. ",
    "Usage: RPBPBR < input.fasta/fastq > < out.pre",
    "Fix > <",
    "type:fasta/fastq >",
    "\\[keep-temp] ",
    "< input.fasta/fastq >",
    "required, the PacBio ",
    "Read file in fasta or fastq format. ",
    "< out.pre",
    "Fix > required, the pre",
    "Put file, and also the name of a temporary directory to be created during the process. ",
    "< type:fasta/fastq > required, the format of the PacBio ",
    "Read file, only can be fasta or fastq, other formats not acceptable. ",
    "\\[keep-temp] optional, if not specified or with value 0, the temporary directory created during the ",
    "Process will be removed after the ",
    "_d)",
    "Output\u2028_",
    "Out",
    "Put file name: < out.predix >.barcode.count.tsv ",
    "Out",
    "Put file is a tabular text file, each line gives the ",
    "Count \\(in the second column) of each barcode listed in the first column. ",
    "Total: total PacBio reads that have been processed. ",
    "Intact: the number of PacBio reads with both 5\u2019 and 3\u2019 adapter sequences. ",
    "Barcodes*: starting from 5\u2019 and end with 3\u2019, barcode segments are connected with hyphens. ",
    "*",
    "In the barcode string, X represents non-recognized segments due to low sequencing quality. \r\n  ",
    "**VII.",
    "Barcode filtering**",
    "This section explains the computation of barcode generation probabilities based on which rare barcodes can be identified.",
    "_a) Software_",
    "\u2022 Data \\(Excel Sheet from RPB, ",
    "See VI.",
    "Barcode identification)",
    "\u2022 Matlab \\(R2013b)",
    "\u2022",
    "barcode_pipeline.m script ",
    "\u2022 data.mat ",
    "o barcode_library  ",
    "_// all possible barcodes_",
    "o path_matrix  _",
    "//",
    "Pgen for a distinct # of recombinations_",
    "o min_list  _// list of minimal number of recombinations_",
    "_b) Software setup_",
    "Copy barcode_pipeline.m and data.mat in desired path. ",
    "Import the following files from experimental data into your Matlab Workspace:",
    "\u2022",
    "A list of found barcodes in cell format ",
    "\u2022",
    "A m by n matrix of reads",
    ", m is the number of barcodes, n the number of populations",
    "\u2022",
    "A list of population names in cell format",
    "_c)",
    "Procedure_",
    "To ",
    "Run barcode_pipeline.m type:",
    "barcode_pipeline \\(< found_codes >, < found_reads >,< population_annotation >)",
    "The pipelines running time varies between < 1 min to 10 minutes depending on the number codes.",
    "Barcode_pipeline first checks all experimentally found barcodes with the complete list of possible barcodes, potentially purging erroneous barcodes from the list.",
    "Then the minimal number of recombinations for every barcode is determined \\(look up in pre-calculated table).",
    "From this minimal recombination number a frequency distribution of recombination events is calculated, which is then used to ",
    "Calculate the generation probabilities for all barcodes.",
    "_d)",
    "Output_",
    "Out",
    "Put is a Matlab-structure with the following fields:",
    "\u2022 purged_codes      _// list of all possible codes in the data-set_",
    "\u2022 purged_reads    _// matrix containing the reads_",
    "\u2022 purged_freq    _// frequencies \u2013 normalized for populations_",
    "\u2022 recombination_frequencies  _// distribution of recombinations 0-10_",
    "\u2022 minimal_recom    _// list of minimal recombinations for all codes_",
    "\u2022 pgen     _",
    "//",
    "Pgen for every code_",
    "\u2022 annotation    _// population-annotation list_"
]