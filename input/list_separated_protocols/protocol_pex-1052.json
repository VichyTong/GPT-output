[
    "\n<p><strong>Demonstration of protocol</strong></p><p>Continuous sensor data (pH and DO) were collected at 15-minute intervals for a 60-day period. During the first 40 days of operation, the bioreactor transitioned toward steady state operation (less than 5% deviation in treatment) characterized by dampened oscillatory behavior.&nbsp;Starting on day 40, a pulse of 1.0 mg/L AgNP was added, and then at subsequent 30-day intervals two more pulses incremented by 1.0 mg/L were added (1.0 mg/L on day 40; 2.0 mg/L on day 70; 3.0 mg/L on day 100). Throughout this period the reactor was operating continuously.&nbsp;The protocol below describes the computational packages and steps required to repeat the analysis, and the approach can be used for any system with the appropriate amount of data. Time series data were stored each week (and backed up on an external hard drive) for subsequent processing vai the protocol below. Excel files with representative data from the experiments (pH and DO data after three pulse additions of nanoparticles) can be found in the supplemental section of this protocol.</p><p><br></p><p><strong>Computational packages:&nbsp;</strong>The steps in the protocol were run with <strong>R</strong> 3.6.1 and the following packages: <em>forecast v8.12</em> (Fourier spectrum)<sup>15</sup>, <em>Rssa 0.13-1</em> (singular spectrum analysis)<sup>16</sup><em>;</em> <em>tseriesChaos 0.1-13</em> (phase space reconstruction and surrogate data analysis) <sup>17</sup>; <em>fractal 2.0-1</em> (compute AAFT surrogates) <sup>18</sup>; <em>multispatialCCM</em><sup><em>19</em></sup><em> </em>(convergent cross mapping); and Code 9.8 (phenomenological modeling) detailed in Huffaker, Bitelli, and Rosa<sup>6</sup>, and available at <a href=\"http://www.dista.unibo.it/~bittelli/\" rel=\"noopener noreferrer\" target=\"_blank\">http://www.dista.unibo.it/~bittelli/</a>. &nbsp;</p><p><br></p><p><strong>Step 1:</strong>&nbsp;Signal processing of the three AgNP pulses for the O<sub>2</sub> and pH records as described in McLamore et al. (2020)<sup>1</sup>.</p><p><strong>Critical Step:</strong> See troubleshooting section for a summary of the failure of signal processing to detect strong signals in sensor data.</p><p><strong>A.</strong> &nbsp;Fourier Frequency Spectrum</p><p>The raw data and results of Fourier analysis are shown in <strong>Fig. 2</strong>. <strong>Fig 2A</strong> shows the raw O<sub>2</sub> data (15 min time scale) and <strong>Fig 2B</strong> shows the raw pH data (60 sec timescale) for three consecutive pulse additions of AgNP (see Excel file in supplemental section for sample data). Fourier spectra (<strong>Fig 2C-D</strong>) are developed using the <em>forecast v8.12</em> package and plotted (the spectrum is generated by the R package). As demonstrated by the peaks in <strong>Fig 2C-D</strong>, the three-pulse series for both O<sub>2</sub> and pH each display a dominant cycle length of 200 (15-minute blocks) = 50 hours. This 50-hour dominant cycle length was easily identifiable in the plots.</p><p><strong>B.</strong>&nbsp;Singular Spectrum Analysis</p><p>Singular Spectrum Analysis (SSA) involves analysis of waveform(s), and then determination of the strength of the signals.&nbsp;To prepare for SSA, each sensor time series is standardized by removing the mean and dividing by the standard deviation.</p><p>The standardized data (black curves) and isolated signals (red curves) resulting from SSA are plotted in <strong>Fig. 3</strong>. Each time course refers to a AgNP concentration following the convention in <strong>Fig 2</strong>. The dominant 50-hour cycle can be adequately captured by resampling the data in 2-hour blocks (i.e., averaging every eight 15-minute blocks).&nbsp;Benefits of this reduction include working with substantially fewer observations, and reducing noise by averaging higher-frequency volatility. <strong>Fig 3</strong> shows the records replotted on a 2-hour time scale, where damped oscillations are apparent for both O<sub>2</sub> and pH.</p><p><strong>Critical Step</strong>: Rerun the Fourier Spectrum on the resampled 2-hour blocks to ensure that it reproduces the dominant 50-hour oscillation in 25 two-hour blocks.&nbsp;</p><p><strong>Critical Step</strong>: When the raw data (black curves in Fig",
    {
        "title": "3)",
        "body": "are plotted with the isolated signals (red curves in Fig 3), the plots will be aligned if there is no noise in the system; that is, if the signal accounts for all of the variation in the sensor record. Since we expect measurements to have some noise (i.e., unstructured variation), we do not expect the curves to be coincident.</p><p><strong>Critical Step</strong>: Some signals contain only one dominant oscillation (see for example <strong>Table 1</strong> and<strong> Fig 3</strong>). For example, pulse 1 for the O<sub>2</sub> sensor data contained one 50-hour dominant oscillation (signal strength of 0.82 in <strong>Table 1</strong> and also black/red curves in <strong>Fig 3A</strong>). Some signals are composed of multiple oscillations, for example, pulse 2 for the O<sub>2</sub> sensor data contained three oscillations (signal strengths in <strong>Table 1</strong> and also black/red/blue curves in <strong>Fig 3C</strong>).</p><p><br></p><p>The package <em>Rssa 0.13-1</em> is used for singular spectrum analysis. <strong>Table 1</strong> reports strength of these signals and constituent oscillations. We note that: (1) Signal strengths are relatively strong in explaining over half the total variation in the corresponding records (with the exception of pH Pulse 3); (2) Strengths are stronger for the O<sub>2</sub> record than the pH record; (3) Strengths tend to decrease as AgNP contamination increases from pulse 1 to 3; and (4) As expected from the Fourier Spectra, 50-hour cycles account for most of signal strength.</p><p><strong>Critical Step</strong>: Determination of whether signal strengths classify as “strong” is done on a case-by-case basis, and requires some expert judgement. In this case, signal strengths were strong in explaining over half the total variation in the corresponding records, as noted above. Care must be taken to establish a benchmark for making the evaluation of signal strengths when conducting singular spectrum analysis. This is similar to the interpretation of regression coefficients in linear plots, where users make judgements on what is a “good” R<sup>2</sup>.</p><p><strong>Step 2:  </strong>Phase Space Reconstruction</p><p><br></p><p>Time delay embedding and surrogate testing were carried out using the package <em>tseriesChaos 0.1-13</em>; <em>fractal 2.0-1</em> was used to compute AAFT surrogates.</p><p><br></p><p><strong>A. </strong>Time-Delay Embedding</p><p>Empirical attractors reconstructed from O<sub>2</sub> and pH signals for the three AgNP pulse series are shown in the <strong>Fig. 4A</strong>. These attractors exhibit geometric regularity in the form of three-dimensional spiral-sink dynamics for each AgNP addition using coordinates of: (1) real-time (current) values of dissolved oxygen, denoted as O<sub>2</sub>(t); (2) dissolved oxygen values with a delay of five two-hour blocks, denoted as O<sub>2 </sub>(t+5); and (3) current values of pH, denoted as pH(t).</p><p><strong>B. </strong>Surrogate Data Testing</p><p><br></p><p>The results of testing the null hypothesis that apparent geometric regularity shown in the empirical attractors was most likely generated by a mimicking linear stochastic process are found in <strong>Table 2</strong>. We see that all O<sub>2</sub> AgNP pulse series’ pass surrogate tests for: (1) predictive skill since NSE values taken from empirical attractors (first column) are among the <em>k</em> largest values taken from surrogate attractors (the <em>k</em> largest values rest above the NSE values reported in the second column); and (2) permutation entropy since values taken from empirical attractors (third column) are among the <em>k</em> smallest values taken from surrogate attractors (the <em>k</em> smallest values rest below the those reported in the fourth column). The surrogate results for the pH signals are more inconclusive. Two of AgNP pulse series (1 and"
    },
    {
        "title": "3)",
        "body": "fail the prediction test; while all three border-line pass the entropy test.</p><p><strong>Critical Step</strong>: Compare empirical attractor characteristics to corresponding surrogate attractor characteristics. Test the null hypothesis that there is no significant difference in the measured characteristics. If null hypothesis is valid, apparent regularity in the empirical attractor is most likely due to linear stochastic dynamics and not deterministic non-linear dynamics.</p><p><br></p><p><strong>Critical Step</strong>: Summary tables of surrogate data testing should be prepared for rapid analysis of predictive skill and permutation entropy tests. See for example summary <strong>Table 2 </strong>and also Overview section B.</p><p><br></p><p><strong>Step 3: </strong>Convergent Cross Mapping (CCM)</p><p><br></p><p>Convergent cross mapping was run with package <em>multispatialCCM</em><sup><em>19</em></sup><em>. </em>CCM results indicate that causal interactions between O<sub>2</sub> and pH shift with increased pulses of AgNP contamination (<strong>Fig. 4B</strong>).  In this example dataset we see that pH remains a relatively strong driver of O<sub>2</sub> for all concentrations of AgNP contamination, since CCM curves converge to correlation coefficients close to one (black curves). In the other direction, O<sub>2</sub> becomes an increasingly weak driver of pH as injected contamination increases (from left to right in the figure), and by AgNP pulse 3 the interaction is indistinguishable from non-causal synchronized behavior, since cross mappings run at backward and forward delays peak at a positive level (<strong>Fig. 4C</strong>, right-most plot). </p><p><br></p><p><strong>Critical Step</strong>: If CCM curves converge to correlation coefficients close to 1.0, this indicates that the process X is a strong driver of Y.</p><p><strong>Critical Step</strong>: The convergence level for the CCM curve is used to infer the relative strength of the causal interaction.</p><p><strong>Critical Step</strong>: When conducting extended CCM, non-zero positive peak values (i.e., greater than one) indicate that the interaction noted in CCM is indistinguishable from non-causal synchronized behavior.</p><p>These shifting interactions are summarized in the causal diagram shown in <strong>Fig. 5</strong>. In this simple example the causal maps are intuitive since there is only two variables and three test conditions, but in more complex data sets the use of causal maps is a highly useful visualization tool for understanding interactions between more than 3 nodes with multiple interactions.</p><p><strong>Critical step:</strong> Causal diagrams are generated in external software based on exported output from package <em>multispatialCCM</em><sup><em>19</em></sup>. </p><p><strong>Step 4:</strong> Phenomenological Modeling</p><p><br></p><p>Code 9.8<sup>6</sup> was used for phenomenological modeling. The phenomenological digital proxies extracted from the O<sub>2</sub> and pH signals are shown in <strong>Fig. 6A </strong>for each AgNP pulse, along with stability information (equilibria and eigenvalues) in <strong>Fig. 6B</strong>. This indicates that the models successfully reproduce the spiral-sink dynamics characterizing empirically-reconstructed bioreactor dynamics. Another indication of success is that the attractors reconstructed from solutions of the phenomenological models bear striking visual resemblance to the empirical attractors (<strong>Fig. 6C</strong>).  Finally, maximum Lyapunov Exponents computed from the empirical and phenomenological attractors were similar as described in McLamore et al <sup>1</sup>.</p><p><strong>Critical Step</strong>: Eigenvalues can be used to determine if the digital proxy successfully reproduces the empirically reconstructed spiral-sink dynamics as described in Huffaker, Bitelli, and Rosa<sup>6</sup>, and available at <a href=\"http://www.dista.unibo.it/~bittelli/\" rel=\"noopener noreferrer\" target=\"_blank\">http://www.dista.unibo.it/~bittelli/</a>. In the case of the example data set shown here, this is the case since the computed eigenvalues are a triplet of a negative real eigenvalue and a complex conjugate pair with negative real parts (as in <strong>Fig 6</strong>).</p><p><strong>Critical Step</strong>: To confirm reproduction of time series dynamics, compute the maximum Lyapunov Exponents from the empirical and phenomenological attractors as described in McLamore et al <sup>1</sup>.</p><p><strong>A.</strong> Causality Quantification</p><p>We used numerical partial derivatives computed from the phenomenological models—measuring the marginal response of a response variable to an incremental change in a driving variable—to quantify the interactions detected with CCM (<strong>Fig. 7</strong>). We observe that when AgNP concentrations are at or below 2.0 mg/L, pH (the system driver) has a negative marginal impact on O<sub>2</sub> (black curves in <strong>Fig. 7A-B</strong>), while O<sub>2</sub> (as the driver) has a positive marginal impact on the pH (red curves in <strong>Fig. 7A-B</strong>). However, the impact of pH on O<sub>2</sub> decays to zero as time progresses. When AgNP concentration is 3.0 mg/L, pH has a detrimental impact on O<sub>2</sub> and this relationship decays with time (<strong>Fig. 7C</strong>).</p><p><strong>Critical Step</strong>: If the curve of X driver on Y output is positive, this indicates a positive marginal impact. Negative values indicate a negative marginal impact.</p><p><strong>Critical Step</strong>: If the curve decays to zero (as in this case for some of the curves), this indicates that over time the impact decays (i.e., is non-persistent).</p><p><br></p>"
    }
]