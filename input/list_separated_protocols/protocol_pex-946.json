[
    "\n<p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Raw sequencing data from mRNA SMARTSeq2 libraries (100bp paired-end [PE]) was converted from bcl to FASTQ format in BaseSpace per sample.</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All FASTQ reads were assessed for quality control using FASTQC and FastQ Screen. FastQ Screen is highly recommended as it assesses the library for sequence origin, ensuring the data match expectations.</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sequencing adapters (Illumina) and low quality read bases were trimmed using Trim Galore, removing reads with a quality Phred score under 6.</p><p>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To align the read sequences to the zebrafish genome, the complete genomic sequence (build GCRz10) file (FASTA) and GTF (general transfer format) / GFF (general feature format) (version",
    {
        "title": "95)",
        "body": "were obtained from Ensembl (downloaded: FA : <a href=\"about:blank\" rel=\"noopener noreferrer\" target=\"_blank\">ftp://ftp.ensembl.org/pub/release-95/fasta/danio_rerio/dna/</a> GTF: <a href=\"about:blank\" rel=\"noopener noreferrer\" target=\"_blank\">ftp://ftp.ensembl.org/pub/release-95/gtf/danio_rerio/</a>)</p><p>5.      Appropriate index files were created using STAR (v2.7.1a): </p><p>STAR --runMode genomeGenerate --runThreadN 4 -genomeSAindexNbases 8 --genomeChrBinNbits 14 --genomeDir ./STARIndex/ --genomeFastaFiles ./GRCz11/Danio_rerio.GRCz11.dna.toplevel.fa --sjdbGTFfile ./GRCz11/Danio_rerio.GRCz11.95.gtf --sjdbOverhang 99</p><p><br></p><p>6.      PE FASTQ reads were aligned using STAR (v2.7.1a) in two-pass mode and guided by the GTF/GFF annotation:</p><p>STAR --readFilesIn ${fq1} ${fq2} --readFilesCommand zcat --genomeDir ./STARIndex/ --runThreadN 4 --twopassMode Basic --outFileNamePrefix ${sample_id} --outSAMtype BAM SortedByCoordinate --outSAMunmapped Within --outSAMheaderHD @HD VN:1.4 --outSAMattrRGline ID:${sample_id} CN:UCL DS:RNAseq LB:Truseq PL:${library.platform} SM:${sample_id}</p><p>7.      Resulting SAM files were sorted by coordinate, converted to BAM format, and indexed using samtools (v1.9): </p><p>samtools sort ${input.sam} -o ${output.sorted.bam} -O bam / samtools index ${output.sorted.bam}</p><p>8.      After mapping, read duplicates were marked using the Picard (v2.20.4) MarkDuplicates command and gene (or transcript) level counts calculated with a module of HTSeq (v0.11.3), htseq-count  keeping duplicate reads:</p><p>htseq-count --order=pos --stranded=no - ./GRCz11/Danio_rerio.GRCz11.95.gtf > ./counts/${BAM_file_name}_htseq_counts_keepdups.tsv</p><p>9.      Quality of mapping was carried out, summarizing the number of mapped, multimapped, unmapped, as well as mapped to exons, intergenic, or intragenic regions using RNA-SeQC/picard metrics/Qualimap. </p><p>10.  Summary reports of all metrics were created using MultiQC (v1.8) <sup>5</sup>.</p><p>11.  The R computing environment (>3.5) and Bioconductor packages, DESeq2 (v1.28.0) was used for statistical modelling of the count data, carrying out pairwise comparisons of optic fissure (OF) tissue and dorsal retina (DR) tissue at each specific developmental time point using WALD testing to generate p values. Metadata of the samples should include; sample id, condition, timepoint. Per sample count data was imported using tximport package, creating a single count dataframe. Low counts were filtered and removed (basemean <10) before modelling. Pairwise comparisons were carried out using specific contrasts called in the DESeq2 command. This ensured the complete dataset was preprocessed and consistent for all comparisons. For the time course analysis, DESeq2 was used with a likelihood-ratio test (LRT) to generate significance values on the complete data set using the interaction of time with tissue origin factors (time:tissue) .</p><p>12.  The data was explored using several graphical plots using ggplot2 in R <sup>11</sup>, including the MA plot – this shows the log2 fold change, per feature, plotted against the mean of normalized counts, for all the samples. An overview of the level of similarity was created using a sample-to-sample distance heatmap, using hierarchical clustering. Principle component analysis (PCA plot) was used to show the samples in a 2D space, separated by the first two principle components, key to identification of outliers and batch effects. All plots can be saved as resolution independent SVG images.</p><p>13.  Differentially expressed genes (DEGs) were defined in this dataset as those having an absolute log2 fold change >= 1 and an FDR <= 0.05. </p><p>14.  (optional) Genes can be further annotated using the biomaRt package <sup>12</sup>; providing common gene name, chromosomal location, biotype and strand specificity as well as associated protein identifiers and homologues in a number of species. </p><p>15.  Gene ontology over representation analysis was carried out using GOseq, which has the benefit of considering any length bias in the data. Alternative tools include GOrilla, DAVID and Enrichr (accessible through web interfaces and APIs). </p><p>16.  Hierarchical clustering of the identified DEGs can be used to identify clades/groups of differentially expressed genes, either up or down regulated in samples represented together colour coded in the heatmap output. The rows of the heatmap (representing an individual gene/transcript) are reordered according to the clustering result, putting similar observations close to one another. Clustering used the rlog transformed assay data from the DESeq2 object. </p><p>17.  For inter sample comparisons of specific gene(s) expression, transcripts per million (TPM) values were calculated <sup>13</sup> and appropriate plots created.</p><p><br></p>"
    }
]